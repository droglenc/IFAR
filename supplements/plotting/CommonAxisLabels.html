---
layout: page
title: Plotting Fundamentals
subtitle: Common Axis Labels on a Grid of Subplots
author: Derek H. Ogle
css: "/css/codebox.css"
---


<p>Several methods for modifying base graphics were shown in the book, including simple layouts (side-by-side, one-over-the-other) of multiple plots. Creating common x- and y-axis labels for a grid of plots is described in this supplement. More complex layouts (e.g., plot in first row spans two columns or unequal sized plots) are <a href="ComplexLayouts.html">described in a separate supplement</a>.</p>
<div id="required-packages-for-this-supplement" class="section level3">
<h3>Required Packages for this Supplement</h3>
<p>Functions used in this supplement require the packages shown below.</p>
<pre class="r"><code>&gt; library(FSAdata)
&gt; library(FSA)
&gt; library(dplyr)</code></pre>
</div>
<div id="data-used-in-this-supplement" class="section level3">
<h3>Data Used in this Supplement</h3>
<p>The <code>BullTroutRML2</code> data from <code>FSAdata</code> are used in this supplement.</p>
<pre class="r"><code>&gt; data(BullTroutRML2)
&gt; BT &lt;- BullTroutRML2
&gt; headtail(BT)</code></pre>
<pre><code>   age  fl     lake     era
1   14 459 Harrison 1977-80
2   12 449 Harrison 1977-80
3   10 471 Harrison 1977-80
94   4 298   Osprey 1997-01
95   3 279   Osprey 1997-01
96   3 273   Osprey 1997-01</code></pre>
<p> </p>
</div>
<div id="common-axis-labels-on-a-grid-of-subplots" class="section level2">
<h2>Common Axis Labels on a Grid of Subplots</h2>
<p>One common graphical desire is to plot multiple graphics in a grid-like format with one axis label that serves as the label for each graph. This can be accomplished with arguments to <code>par()</code>, but the regions of a plot must be undersood first (the description that follows is modified <a href="http://research.stowers-institute.org/efg/R/Graphics/Basics/mar-oma/index.htm">from here</a>).</p>
<p>Each plot consists of three regions – the plot area, the figure area, and the outer margin area Figure 1. The plot area is where the points or bars will be graphed. The area between the plot area and the figure area is where the axis ticks, labels, and title will appear. The area outside of the figure area is the outer margin area and is generally used to proivde extra space around the graphic or to place text. In most instances (and the default), the width of the outer margin area is 0 on all sides of the figure area such that no outer margin area exists. The size of the outer margin area is set with <code>oma=</code> in <code>par()</code>, which takes a vector of four values to serve as widths of the four sides of the outer margin area, beginning with the bottom and moving counter-clockwise. The default is <code>par(oma=c(0,0,0,0))</code>, but margins that are two “lines” wide on the top and bottom and one “line” wide on the left and right are set with <code>par(oma=c(2,1,2,1))</code>.</p>
<p><img src="CommonAxisLabels_files/figure-html/unnamed-chunk-5-1.png" title="" alt="" width="336" /></p>
<p>Figure 1: Schematic plot that illustrates the plotting area (inside the blue box), the figure area (inside the red box), and the outer margin area (between the dark gray and red boxes).</p>
<p>Common axis labels for multiple graphs can be placed in the outer margin area. In the example below, a 2-by-2 grid is created with <code>mfrow()</code> (as described in the book) and the bottom and left outer margin areas are increased to be three “lines” wide to allow for common x- and y-axis labels.</p>
<pre class="r"><code>&gt; par(mfrow=c(2,2),oma=c(2,2,0,0))</code></pre>
<p>The four subplot areas are then populated with scatterplots (note that the x- and y-axis labels are set to empty strings to suppress labeling the axes)</p>
<pre class="r"><code>&gt; xlmts &lt;- c(-0.5,14.5)
&gt; ylmts &lt;- c(0,700)
&gt; BTH1 &lt;- BT %&gt;% filterD(lake==&quot;Harrison&quot;,era==&quot;1977-80&quot;)
&gt; plot(fl~age,data=BTH1,main=&quot;Harrison, 1977-80&quot;,
       xlab=&quot;&quot;,ylab=&quot;&quot;,pch=19,xlim=xlmts,ylim=ylmts)</code></pre>
<pre class="r"><code>&gt; BTO1 &lt;- BT %&gt;% filterD(lake==&quot;Osprey&quot;,era==&quot;1977-80&quot;)
&gt; plot(fl~age,data=BTO1,main=&quot;Osprey, 1977-80&quot;,
       xlab=&quot;&quot;,ylab=&quot;&quot;,pch=19,xlim=xlmts,ylim=ylmts)</code></pre>
<pre class="r"><code>&gt; BTH2 &lt;- BT %&gt;% filterD(lake==&quot;Harrison&quot;,era==&quot;1997-01&quot;)
&gt; plot(fl~age,data=BTH2,main=&quot;Harrison, 1997-01&quot;,
       xlab=&quot;&quot;,ylab=&quot;&quot;,pch=19,xlim=xlmts,ylim=ylmts)</code></pre>
<pre class="r"><code>&gt; BTO2 &lt;- BT %&gt;% filterD(lake==&quot;Osprey&quot;,era==&quot;1997-01&quot;)
&gt; plot(fl~age,data=BTO2,main=&quot;Osprey, 1997-01&quot;,
       xlab=&quot;&quot;,ylab=&quot;&quot;,pch=19,xlim=xlmts,ylim=ylmts)</code></pre>
<p>The common x- and y-axis labels are then placed in the outer margin areas with <code>mtext()</code>. In this capacity, <code>mtext()</code> requires the text to be written as the first argument, a number in <code>side=</code> that indicates the margin on which to print the text (note that the <code>side=</code> argument in <code>mtext()</code> uses the same numbering scheme as other functions – 1=bottom, 2=left, 3=top, 4=right), a number in <code>line=</code> that indicates the line on which to print the text (defaults to 0), and <code>outer=TRUE</code> to force the text into the outer margin area. Further note that <code>las=0</code> is used for the y-axis label to force the text to be parallel to the y-axis. This is only needed because <code>las=1</code> was set globablly for producing this book.</p>
<p>The code below adds common x- and y-axis labels to the plots constructed above. The final plot is shown in Figure 2.</p>
<pre class="r"><code>&gt; mtext(&quot;Age (years)&quot;,side=1,line=0,outer=TRUE,cex=1.3)
&gt; mtext(&quot;Fork Length (mm)&quot;,side=2,line=0,outer=TRUE,cex=1.3,las=0)</code></pre>
<p><img src="CommonAxisLabels_files/figure-html/unnamed-chunk-6-1.png" title="" alt="" width="672" /></p>
<p>Figure 2: Grid of plots that uses the outer margin area to provide common axis labels.</p>
<p> </p>
<hr />
</div>
<div id="reproducibility-information" class="section level2">
<h2>Reproducibility Information</h2>
<ul>
<li><strong>Compiled Date:</strong> Thu Nov 05 2015</li>
<li><strong>Compiled Time:</strong> 12:40:05 PM</li>
<li><strong>R Version:</strong> R version 3.2.2 (2015-08-14)</li>
<li><strong>System:</strong> Windows, i386-w64-mingw32/i386 (32-bit)</li>
<li><strong>Base Packages:</strong> base, datasets, graphics, grDevices, methods, stats, utils</li>
<li><strong>Required Packages:</strong> FSAdata, FSA, dplyr, captioner, knitr and their dependencies (assertthat, car, DBI, digest, evaluate, formatR, gdata, gplots, graphics, grDevices, highr, Hmisc, lazyeval, magrittr, markdown, methods, plotrix, plyr, R6, Rcpp, sciplot, stats, stringr, tools, utils, yaml)</li>
<li><strong>Other Packages:</strong> captioner_2.2.3, dplyr_0.4.3, extrafont_0.17, FSA_0.8.4, FSAdata_0.3.2, knitr_1.11, magrittr_1.5, rmarkdown_0.8.1, stringr_1.0.0, tidyr_0.3.1</li>
<li><strong>Loaded-Only Packages:</strong> assertthat_0.1, DBI_0.3.1, digest_0.6.8, evaluate_0.8, extrafontdb_1.0, formatR_1.2.1, gdata_2.17.0, gtools_3.5.0, highr_0.5.1, htmltools_0.2.6, lazyeval_0.1.10, parallel_3.2.2, plyr_1.8.3, R6_2.1.1, Rcpp_0.12.1, Rttf2pt1_1.3.3, stringi_1.0-1, tools_3.2.2, yaml_2.1.13</li>
<li><strong>Links:</strong> <a href="CommonAxisLabels.R">Script</a> / <a href="CommonAxisLabels.Rmd">RMarkdown</a></li>
</ul>
<hr />
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
