---
layout: page
title: Individual Growth
subtitle: Other VBGF Parameterizations
author: Derek H. Ogle
css: "/css/codebox.css"
---


<p>The von Bertalanffy Growth Function (VBGF) was introduced and methods for fitting the function were illustrated in Chapter 12 of the <a href="http://derekogle.com/IFAR/"><em>Introductory Fisheries Analyses with R</em></a> (IFAR) book. The VBGF used there is from <span class="citation">Beverton and Holt (1957)</span> and is called the “Typical” parameterization of the VBGF. The VBGF can be expressed in alternative forms that are called parameterizations. The most common parameterizations of the VBGF may be seen with <code>vbModels()</code> from <code>FSA</code>.</p>
<p>Different parameterizations do not fit the data differently. In other words, all parameterizations of the VBGF have the same number of parameters and will produce the same predicted values and fitted model plots. However, different parameterizations have different function parameters that may be of interest to the fisheries scientist for biological reasons or because they have useful statistical properties. For example, the parameterizations of <span class="citation"><span>von <span>B</span>ertalanffy</span> (1938)</span> and <span class="citation">Mooij et al. (1999)</span> both use <span class="math">\(L_{0}\)</span>, which is the mean length at time 0 (i.e., at “hatch”). Thus, either of these parameterizations could be used if the <span class="math">\(L_{0}\)</span> parameter was of biological interest. In contrast, the parameters in the parameterizations of <span class="citation">Schnute (1981)</span> and <span class="citation">Francis (1988)</span> are either largely or wholly based on expected values, which are generally less correlated. Thus, if one wants to avoid the problems associated with highly correlated parameters (as discussed in the <strong>IFAR</strong> book) and is not interested in the parameters of the other parameterizations, then either of these two parameterizations may be used.</p>
<p>The parametarization of <span class="citation">Francis (1988)</span> will be fit in this supplement to illustrate fitting other than the “Typical” parameterization used in Chapter 12 of the <strong>IFAR</strong> book. Other supplements demonstrate how to <a href="OtherGrowthFuns.html">fit other growth functions</a> and <a href="OtherNLAlgorithms.html">use alternative nonlinear model fitting algorithms</a>.</p>
<p> </p>
<div id="required-packages-for-this-supplement" class="section level3">
<h3>Required Packages for this Supplement</h3>
<p>Functions used in this supplement require the packages shown below.</p>
<pre class="r"><code>&gt; library(FSA)
&gt; library(dplyr)
&gt; library(nlstools)</code></pre>
</div>
<div id="data-used-in-this-supplement" class="section level3">
<h3>Data Used in this Supplement</h3>
<p>The male Black Drum data (<a href="https://github.com/droglenc/FSAdata/blob/master/data-raw/BlackDrum2001.csv">view</a>, <a href="https://raw.githubusercontent.com/droglenc/FSAdata/master/data-raw/BlackDrum2001.csv">download</a>, <a href="http://derekogle.com/fishR/data/data-html/BlackDrum2001.html">meta-data</a>) used in the <strong>IFAR</strong> book are also used in this supplement.</p>
<pre class="r"><code>&gt; bdmf &lt;- read.csv(&quot;BlackDrum2001.csv&quot;) %&gt;%
    select(-c(spname,day,weight)) %&gt;%
    filterD(sex %in% c(&quot;male&quot;,&quot;female&quot;),otoage&lt;50)
&gt; bdm &lt;- filterD(bdmf,sex==&quot;male&quot;)
&gt; headtail(bdm)</code></pre>
<pre><code>   year agid month     tl  sex otoage
1  2001    1     4  787.5 male      6
2  2001    2     5  700.0 male      5
3  2001    8     5 1140.0 male     23
72 2001  122     5 1175.0 male     39
73 2001  125     6  590.0 male      4
74 2001  127     6  530.0 male      3</code></pre>
<p> </p>
</div>
<div id="fitting-other-vbgf-parameterizations" class="section level2">
<h2>Fitting Other VBGF Parameterizations</h2>
<p>The <span class="citation">Francis (1988)</span> parameterization is defined as</p>
<p><span class="math">\[ E[L|t] = L_{1} + (L_{3}-L_{1})\frac{1-r^{2\frac{t-t_{1}}{t_{3}-t_{1}}}}{1-r^{2}} \]</span></p>
<p>where</p>
<p><span class="math">\[ r=\frac{L_{3}-L_{2}}{L_{2}-L_{1}} \]</span></p>
<p>The function parameters are <span class="math">\(L_{1}\)</span>, <span class="math">\(L_{2}\)</span>, and <span class="math">\(L_{3}\)</span>, which represent the mean lengths at ages <span class="math">\(t_{1}\)</span>, <span class="math">\(t_{2}\)</span>, and <span class="math">\(t_{3}\)</span>, respectively, where <span class="math">\(t_{1}\)</span> and <span class="math">\(t_{3}\)</span> are relatively young and old ages chosen by the user and <span class="math">\(t_{2}\)</span> is the average of <span class="math">\(t_{1}\)</span> and <span class="math">\(t_{3}\)</span>.</p>
<p>As demonstrated in the <strong>IFAR</strong> chapter for the “Typical” VBGF, an R function that uses the VBGF to predict length from a given age is needed. This R function may be created by the user, but for the common parameterizations shown in <code>vbModels()</code> it is easier to use <code>vbFuns()</code> from <code>FSA</code>. As a reminder, <code>vbFuns()</code> requires the name for the parameterization to use in quotes as the first argument. A brief explanation of the parameters is also returned if <code>msg=TRUE</code> is included in <code>vbFuns()</code>.</p>
<p>An R function called <code>vbF()</code> is created for the “Francis” parameterization below. Note with this function that values for the three parameters may be included as a vector in <code>L1=</code> and that the youngest and oldest ages may be included as a vector in <code>t1=</code>.</p>
<pre class="r"><code>&gt; ( vbF &lt;- vbFuns(&quot;Francis&quot;) )</code></pre>
<pre><code>function(t,L1,L2=NULL,L3=NULL,t1,t3=NULL) {
  if (length(L1)==3) { L2 &lt;- L1[[2]]; L3 &lt;- L1[[3]]; L1 &lt;- L1[[1]] }
  if (length(t1)==2) { t3 &lt;- t1[[2]]; t1 &lt;- t1[[1]] }
  r &lt;- (L3-L2)/(L2-L1)
  L1+(L3-L1)*((1-r^(2*((t-t1)/(t3-t1))))/(1-r^2))
}
&lt;environment: 0x050faa7c&gt;</code></pre>
<p>As stated above, the user must choose values for <span class="math">\(t_{1}\)</span> and <span class="math">\(t_{3}\)</span>. In this example, I have chosen to use the youngest and oldest ages in the data (as found with <code>range()</code>).</p>
<pre class="r"><code>&gt; ( ages &lt;- range(bdm$otoage) )</code></pre>
<pre><code>[1]  3 42</code></pre>
<p>Starting values are obtained with <code>vbStarts()</code> as described in the <strong>IFAR</strong> chapter. However, with the “Francis” parameterization, the ages that define <span class="math">\(t_{1}\)</span> and <span class="math">\(t_{3}\)</span> must also be provided in <code>ages2use=</code>.</p>
<pre class="r"><code>&gt; ( svF &lt;- vbStarts(tl~otoage,data=bdm,type=&quot;Francis&quot;,ages2use=ages) )</code></pre>
<pre><code>$L1
[1] 572.775

$L2
[1] 1139.625

$L3
[1] 1205</code></pre>
<p>The VBGF is fit and parameter estimates with likelihood profile confidence intervals are obtained as described in the <strong>IFAR</strong> book, with the exception that the vector that defines the youngest and oldest ages must be supplied to <code>vbF()</code>. Bootstrapped confidence intervals and predictions may also be obtained as described in the <strong>IFAR</strong> book.</p>
<pre class="r"><code>&gt; nlsF &lt;- nls(tl~vbF(otoage,L1,L2,L3,t1=ages),data=bdm,start=svF)
&gt; cbind(Ests=coef(nlsF),confint(nlsF))</code></pre>
<pre><code>Waiting for profiling to be done...</code></pre>
<pre><code>       Ests      2.5%     97.5%
L1  572.975  533.2025  612.3236
L2 1157.463 1145.6535 1169.2496
L3 1194.248 1176.6756 1212.7376</code></pre>
<pre class="r"><code>&gt; bootF &lt;- nlsBoot(nlsF)
&gt; cbind(Ests=coef(nlsF),confint(bootF))</code></pre>
<pre><code>       Ests   95% LCI   95% UCI
L1  572.975  533.7766  609.4586
L2 1157.463 1145.7926 1168.1054
L3 1194.248 1177.3276 1211.8082</code></pre>
<pre class="r"><code>&gt; predict(bootF,vbF,t=3,t1=ages)</code></pre>
<pre><code>prediction    95% LCI    95% UCI 
  572.5095   533.7766   609.4586 </code></pre>
<p>Note that the intra-parameter correlations are relatively low for this parameterization. Additionally, the scale of the parameters in the “Francis” parameterization are usually similar. Both of these characteristics may aid model convergence.</p>
<pre class="r"><code>&gt; summary(nlsF,correlation=TRUE)</code></pre>
<pre><code>
Formula: tl ~ vbF(otoage, L1, L2, L3, t1 = ages)

Parameters:
   Estimate Std. Error t value Pr(&gt;|t|)
L1  572.975     19.424    29.5   &lt;2e-16
L2 1157.463      5.910   195.9   &lt;2e-16
L3 1194.248      8.717   137.0   &lt;2e-16

Residual standard error: 45.6 on 71 degrees of freedom

Correlation of Parameter Estimates:
   L1    L2   
L2 -0.16      
L3  0.17  0.65

Number of iterations to convergence: 5 
Achieved convergence tolerance: 3.023e-06</code></pre>
<p> </p>
<hr />
</div>
<div id="reproducibility-information" class="section level2">
<h2>Reproducibility Information</h2>
<ul>
<li><strong>Compiled Date:</strong> Fri Nov 06 2015</li>
<li><strong>Compiled Time:</strong> 9:06:37 AM</li>
<li><strong>R Version:</strong> R version 3.2.2 (2015-08-14)</li>
<li><strong>System:</strong> Windows, i386-w64-mingw32/i386 (32-bit)</li>
<li><strong>Base Packages:</strong> base, datasets, graphics, grDevices, methods, stats, utils</li>
<li><strong>Required Packages:</strong> FSA, dplyr, nlstools, captioner, knitr and their dependencies (assertthat, car, DBI, digest, evaluate, formatR, gdata, gplots, graphics, grDevices, highr, Hmisc, lazyeval, magrittr, markdown, methods, plotrix, plyr, R6, Rcpp, sciplot, stats, stringr, tools, utils, yaml)</li>
<li><strong>Other Packages:</strong> captioner_2.2.3, dplyr_0.4.3, extrafont_0.17, FSA_0.8.4, knitr_1.11, nlstools_1.0-2</li>
<li><strong>Loaded-Only Packages:</strong> assertthat_0.1, DBI_0.3.1, digest_0.6.8, evaluate_0.8, extrafontdb_1.0, formatR_1.2.1, gdata_2.17.0, gtools_3.5.0, htmltools_0.2.6, lazyeval_0.1.10, magrittr_1.5, MASS_7.3-44, parallel_3.2.2, plyr_1.8.3, R6_2.1.1, Rcpp_0.12.1, rmarkdown_0.8.1, Rttf2pt1_1.3.3, stringi_1.0-1, stringr_1.0.0, tools_3.2.2, yaml_2.1.13</li>
<li><strong>Links:</strong> <a href="OtherVBGFParams.R">Script</a> / <a href="OtherVBGFParams.Rmd">RMarkdown</a></li>
</ul>
<hr />
<p> </p>
<div class="references">
<h2>References</h2>
<p>Beverton, R. J. H., and S. J. Holt. 1957. On the dynamics of exploited fish populations. Page 533. United Kingdom Ministry of Agriculture; Fisheries.</p>
<p>Francis, R. I. C. C. 1988. Are growth parameters estimated from tagging and age-length data comparable? Canadian Journal of Fisheries and Aquatic Sciences 45:936–942.</p>
<p>Mooij, W. M., J. M. V. Rooij, and S. Wijnhoven. 1999. Analysis and comparison of fish growth from small samples of length-at-age data: Detection of sexual dimorphism in Eurasian Perch as an example. Transactions of the American Fisheries Society 128:483–490.</p>
<p>Schnute, J. 1981. A versatile growth model with statistically stable parameters. Canadian Journal of Fisheries and Aquatic Sciences 38:1128–1140.</p>
<p><span>von <span>B</span>ertalanffy</span>, L. 1938. A quantitative theory of organic growth (inquiries on growth laws II). Human Biology 10:181–213.</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
