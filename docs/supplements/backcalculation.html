<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Derek H. Ogle">

<title>IFAR - Backcalculation of Previous Lengths</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<link href="..//img/IFARCover_small.jpg" rel="icon" type="image/jpeg">
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../css/styles.css">
<meta property="og:title" content="IFAR - Backcalculation of Previous Lengths">
<meta property="og:description" content="">
<meta property="og:site-name" content="IFAR">
<meta name="citation_title" content="Backcalculation of Previous Lengths">
<meta name="citation_author" content="Derek H. Ogle">
<meta name="citation_fulltext_html_url" content="https://droglenc.github.io/IFAR//supplements/backcalculation.html">
<meta name="citation_language" content="en">
<meta name="citation_reference" content="citation_title=Introductory Fisheries Analyses with R;,citation_author=Derek H. Ogle;,citation_publication_date=2016;,citation_cover_date=2016;,citation_year=2016;,citation_fulltext_html_url=http://derekogle.com/IFAR/book/;">
<meta name="citation_reference" content="citation_title=On the Dynamics of Exploited Fish Populations;,citation_author=R. J. H. Beverton;,citation_author=S. J. Holt;,citation_publication_date=1957;,citation_cover_date=1957;,citation_year=1957;,citation_volume=19;,citation_series_title=Fisheries Investigations (Series 2);">
<meta name="citation_reference" content="citation_title=Standard intercepts for calculating lengths from scale measurements for some centrarchid and percid fishes;,citation_author=K. D. Carlander;,citation_publication_date=1982;,citation_cover_date=1982;,citation_year=1982;,citation_volume=111;,citation_journal_title=Transactions of the American Fisheries Society;">
<meta name="citation_reference" content="citation_title=Minpack.lm: R Interface to the Levenberg-Marquardt Nonlinear Least-Squares Algorithm Found in MINPACK, Plus Support for Bounds;,citation_author=Timur V. Elzhov;,citation_author=Katharine M. Mullen;,citation_author=Andrej-Nikolai Spiess;,citation_author=Ben M. Bolker;,citation_publication_date=2013;,citation_cover_date=2013;,citation_year=2013;,citation_fulltext_html_url=http://CRAN.R-project.org/package=minpack.lm;">
<meta name="citation_reference" content="citation_title=Are growth parameters estimated from tagging and age-length data comparable?;,citation_author=R. I. C. C. Francis;,citation_publication_date=1988;,citation_cover_date=1988;,citation_year=1988;,citation_volume=45;,citation_journal_title=Canadian Journal of Fisheries and Aquatic Sciences;">
<meta name="citation_reference" content="citation_title=Back-calculation of fish length: A critical review;,citation_author=R. I. C. C. Francis;,citation_publication_date=1990;,citation_cover_date=1990;,citation_year=1990;,citation_volume=36;,citation_journal_title=Journal of Fish Biology;">
<meta name="citation_reference" content="citation_title=Growth of the spring salmon;,citation_author=C. McL. Fraser;,citation_publication_date=1916;,citation_cover_date=1916;,citation_year=1916;,citation_volume=1915;,citation_journal_title=Transactions of the Pacific Fisheries Society;">
<meta name="citation_reference" content="citation_title=On the nature of the function expressive of the law of human mortality and on a new mode of determining the value of life contingencies.;,citation_author=B. Gompertz;,citation_publication_date=1825;,citation_cover_date=1825;,citation_year=1825;,citation_volume=115;,citation_journal_title=Philosophical Transactions of the Royal Society of London;">
<meta name="citation_reference" content="citation_title=Dates and times made easy with lubridate;,citation_author=Garrett Grolemund;,citation_author=Hadley Wickham;,citation_publication_date=2011;,citation_cover_date=2011;,citation_year=2011;,citation_fulltext_html_url=http://www.jstatsoft.org/v40/i03/;,citation_issue=3;,citation_volume=40;,citation_journal_title=Journal of Statistical Software;">
<meta name="citation_reference" content="citation_title=nls2: Non-Linear Regression with Brute Force;,citation_author=G. Grothendieck;,citation_publication_date=2013;,citation_cover_date=2013;,citation_year=2013;,citation_fulltext_html_url=http://CRAN.R-project.org/package=nls2;">
<meta name="citation_reference" content="citation_title=On the methods used in the Herring-investigations.;,citation_author=E. Lea;,citation_publication_date=1910;,citation_cover_date=1910;,citation_year=1910;,citation_issue=1;,citation_volume=108;,citation_journal_title=Publ. Circonst. Cons. perm. int. Explor. Mer;">
<meta name="citation_reference" content="citation_title=A review of the methods of age and growth determination in fishes by means of scales.;,citation_author=R. M. Lee;,citation_publication_date=1920;,citation_cover_date=1920;,citation_year=1920;,citation_issue=(2);,citation_volume=4;,citation_journal_title=Fisheries Investigations, London Series 2;">
<meta name="citation_reference" content="citation_title=Analysis and comparison of fish growth from small samples of length-at-age data: Detection of sexual dimorphism in Eurasian Perch as an example;,citation_author=W. M. Mooij;,citation_author=J. M. Van Rooij;,citation_author=S. Wijnhoven;,citation_publication_date=1999;,citation_cover_date=1999;,citation_year=1999;,citation_volume=128;,citation_journal_title=Transactions of the American Fisheries Society;">
<meta name="citation_reference" content="citation_title=Fitting curves to data using nonlinear regression: A practical and nonmathematical review;,citation_abstract=Many types of data are best analyzed by fitting a curve using nonlinear regression, and computer programs that perform these calculations are readily available. Like every scientific technique, however, a nonlinear regression program can produce misleading results when used inappropriately. This article reviews the use of nonlinear regression in a practical and nonmathematical manner to answer the following questions: Why is nonlinear regression superior to linear regression of transformed data? How does nonlinear regression differ from polynomial regression and cubic spline? How do nonlinear regression programs work? What choices must an investigator make before performing nonlinear regression? What do the final results mean? How can two sets of data or two fits to one set of data be compared? What problems can cause the results to be wrong? This review is designed to demystify nonlinear regression so that both its power and its limitations will be appreciated.;,citation_author=H. J. Motulsky;,citation_author=L. A. Ransnas;,citation_publication_date=1987;,citation_cover_date=1987;,citation_year=1987;,citation_fulltext_html_url=http://www.fasebj.org/content/1/5/365.full.pdf+html;,citation_volume=1;,citation_journal_title=The Federation of American Societies for Experimental Biology Journal;">
<meta name="citation_reference" content="citation_title=Nlmrt: Functions for Nonlinear Least Squares Solutions;,citation_author=John C. Nash;,citation_publication_date=2014;,citation_cover_date=2014;,citation_year=2014;,citation_fulltext_html_url=http://CRAN.R-project.org/package=nlmrt;">
<meta name="citation_reference" content="citation_title=Ruffe length-weight relationships with a proposed standard weight equation;,citation_author=D. H. Ogle;,citation_author=I. J. Winfield;,citation_publication_date=2009;,citation_cover_date=2009;,citation_year=2009;,citation_fulltext_html_url=http://www.tandfonline.com/doi/abs/10.1577/M08-176.1#.U6ojzvldV8E;,citation_volume=29;,citation_journal_title=North American Journal of Fisheries Management;">
<meta name="citation_reference" content="citation_title=Methods for Assessing Fish Populations;,citation_author=Kevin L. Pope;,citation_author=Steve E. Lochmann;,citation_author=Michael K. Young;,citation_editor=W. A. Hubert;,citation_editor=M. C. Quist;,citation_publication_date=2010;,citation_cover_date=2010;,citation_year=2010;,citation_inbook_title=Inland Fisheries Management in North America;">
<meta name="citation_reference" content="citation_title=A flexible growth function for empirical use;,citation_author=F. J. Richards;,citation_publication_date=1959;,citation_cover_date=1959;,citation_year=1959;,citation_volume=10;,citation_journal_title=Journal of Experimental Botany;">
<meta name="citation_reference" content="citation_title=Computation and Interpretation of Biological Statistics of Fish Populations;,citation_author=W. E. Ricker;,citation_publication_date=1975;,citation_cover_date=1975;,citation_year=1975;,citation_technical_report_institution=Bulletin of the Fisheries Research Board of Canada;,citation_technical_report_number=Bulletin 191;">
<meta name="citation_reference" content="citation_title=A versatile growth model with statistically stable parameters;,citation_author=J. Schnute;,citation_publication_date=1981;,citation_cover_date=1981;,citation_year=1981;,citation_volume=38;,citation_journal_title=Canadian Journal of Fisheries and Aquatic Sciences;">
<meta name="citation_reference" content="citation_title=A unified approach to the analysis of fish growth, maturity, and survivorship data;,citation_author=J. T. Schnute;,citation_author=L. J. Richards;,citation_publication_date=1990;,citation_cover_date=1990;,citation_year=1990;,citation_volume=47;,citation_journal_title=Canadian Journal of Fisheries and Aquatic Sciences;">
<meta name="citation_reference" content="citation_title=The back-calculation of fish growth from otoliths;,citation_author=L. Vigliola;,citation_author=M. G. Meekan;,citation_editor=B. S. Green;,citation_editor=B. D. Mapstone;,citation_editor=G. Carlos;,citation_editor=G. A. Begg;,citation_publication_date=2009;,citation_cover_date=2009;,citation_year=2009;,citation_inbook_title=Tropical Fish Otoliths: Information for Assessment, Management, and Ecology;,citation_series_title=Reviews: Methods and Technologies in Fish Biology and Fisheries;">
<meta name="citation_reference" content="citation_title=A quantitative theory of organic growth (inquiries on growth laws II);,citation_author=L. Bertalanffy;,citation_publication_date=1938;,citation_cover_date=1938;,citation_year=1938;,citation_volume=10;,citation_journal_title=Human Biology;">
<meta name="citation_reference" content="citation_title=Using hard-part increment data to estimate age and environmental effects;,citation_author=S. Weisberg;,citation_publication_date=1993;,citation_cover_date=1993;,citation_year=1993;,citation_issue=6;,citation_volume=50;,citation_journal_title=Canadian Journal of Fisheries and Aquatic Sciences;">
<meta name="citation_reference" content="citation_title=Interpretation of body-scale regression for computing body length of fish.;,citation_author=R. R. Whitney;,citation_author=K. D. Carlander;,citation_publication_date=1956;,citation_cover_date=1956;,citation_year=1956;,citation_volume=20;,citation_journal_title=Journal of Wildlife Management;">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Introductory Fisheries Analyses with R by Derek H. Ogle</span>
    </a>
  </div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup">Setup</a>
  <ul class="collapse">
  <li><a href="#packages" id="toc-packages" class="nav-link" data-scroll-target="#packages">Packages</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a></li>
  </ul></li>
  <li><a href="#terminology" id="toc-terminology" class="nav-link" data-scroll-target="#terminology">Terminology</a></li>
  <li><a href="#common-back-calculation-models" id="toc-common-back-calculation-models" class="nav-link" data-scroll-target="#common-back-calculation-models">Common Back-Calculation Models</a></li>
  <li><a href="#data-organization-manipulation" id="toc-data-organization-manipulation" class="nav-link" data-scroll-target="#data-organization-manipulation">Data Organization &amp; Manipulation</a></li>
  <li><a href="#computing-back-calculated-lengths" id="toc-computing-back-calculated-lengths" class="nav-link" data-scroll-target="#computing-back-calculated-lengths">Computing Back-Calculated Lengths</a>
  <ul class="collapse">
  <li><a href="#scale-length-relationships" id="toc-scale-length-relationships" class="nav-link" data-scroll-target="#scale-length-relationships">Scale-Length Relationships</a></li>
  <li><a href="#applying-the-back-calculation-models" id="toc-applying-the-back-calculation-models" class="nav-link" data-scroll-target="#applying-the-back-calculation-models">Applying the Back-Calculation Models</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Backcalculation of Previous Lengths</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Derek H. Ogle </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <code>RFishBC</code> package has functions to acquire growth increment data from images of ageing structures and to ease back-calculation computations. Please see <a href="https://fishr-core-team.github.io/RFishBC/">the vignettes for <code>RFishBC</code></a> for a more thorough description of back-calculating previous lengths.</p>
</div>
</div>
<p>&nbsp;</p>
<p><span class="citation" data-cites="francis_back-calculation_1990">Francis (<a href="#ref-francis_back-calculation_1990" role="doc-biblioref">1990</a>)</span> defined <em>back-calculation</em> as “<em>… a technique that uses a set of measurements made on a fish at one time to infer its length at an earlier time or times. Specifically, the dimensions of one or more marks in some hard part of the fish, together with its current body length, are used to estimate its length at the time of formation of each of the marks. … The marks are generally annual rings associated with growth checks, … .</em>” Thus, backcalculation is the reconstruction of the length of a fish at previous ages from measurements made on calcified structures.</p>
<section id="setup" class="level1 page-columns page-full">
<h1>Setup</h1>
<section id="packages" class="level2">
<h2 class="anchored" data-anchor-id="packages">Packages</h2>
<p>Functions used in this supplement require the following packages.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FSA)      <span class="co"># for peek(), headtail(), sumtable()</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)    <span class="co"># for filter(), select(), mutate(), arrange(), group_by(), summarize()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Also note that single functions from the <code>tidyr</code> and <code>stringr</code> packages are used with <code>::</code> so that the whole packages are not loaded here.</p>
</section>
<section id="data" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="data">Data</h2>
<div class="page-columns page-full"><p>All analyses in this supplement use the West Bearskin Lake (MN) Smallmouth Bass (<em>Micropterus dolomieu</em>) data from <span class="citation" data-cites="weisberg_using_1993">Weisberg (<a href="#ref-weisberg_using_1993" role="doc-biblioref">1993</a>)</span> found in <a href="https://fishr-core-team.github.io/FSA/reference/SMBassWB.html">SMBassWB</a>.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> The analysis in this supplement will focus on those fish captured in 1990. Three variables that were constant and not used in this analysis and three measurement variables that corresponded to ages that did not exist after reducing to only fish captured in 1990 were removed to save space.</p><div class="no-row-height column-margin column-container"><li id="fn1"><p><sup>1</sup>&nbsp;Download data with CSV link on the linked page.</p></li></div></div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>SMBassWB <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://raw.githubusercontent.com/fishR-Core-Team/FSA/main/data-raw/SMBassWB.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">

</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>wb90 <span class="ot">&lt;-</span> SMBassWB <span class="sc">|&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(yearcap<span class="sc">==</span><span class="dv">1990</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>(species<span class="sc">:</span>gear),<span class="sc">-</span>(anu10<span class="sc">:</span>anu12))</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">peek</span>(wb90,<span class="at">n=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#R|      yearcap fish agecap lencap    anu1    anu2    anu3    anu4    anu5    anu6
#R|  1      1990  482      1     75 1.51076      NA      NA      NA      NA      NA
#R|  45     1990  431      3    130 1.01867 2.04110 3.22882      NA      NA      NA
#R|  90     1990  453      3    165 1.63068 2.96180 3.96131      NA      NA      NA
#R|  136    1990  382      7    225 1.33285 2.42372 3.04270 3.79372 4.86226 5.74919
#R|  181    1990  389      9    329 1.05913 2.18769 3.55137 4.40766 5.78634 7.58178
#R|         anu7    anu8     anu9   radcap
#R|  1        NA      NA       NA  1.51076
#R|  45       NA      NA       NA  3.22882
#R|  90       NA      NA       NA  3.96131
#R|  136 6.47536      NA       NA  6.47536
#R|  181 8.32094 9.46362 10.43491 10.43491</code></pre>
</div>
</div>
<p>&nbsp;</p>
</section>
</section>
<section id="terminology" class="level1">
<h1>Terminology</h1>
<p>Two types of measurements can be made on calcified structures. A <em>radial</em> measurement is the total distance from the center of the structure (e.g., focus of scale or nucleus of otolith) to the edge of an annulus. An <em>incremental</em> measurement is the distance between two successive annuli. Radial measurements are required for back-calculation of fish length.</p>
<p>Back-calculation models estimate length at previous age <span class="math inline">\(i\)</span> (i.e., <span class="math inline">\(L_{i}\)</span>) from known values of length at time of capture (<span class="math inline">\(L_{C}\)</span>), scale radius to the <span class="math inline">\(i\)</span>th annulus (<span class="math inline">\(S_{i}\)</span>), and scale radius at time of capture (<span class="math inline">\(S_{C}\)</span>). Several back-calculation models rely on the relationship between <span class="math inline">\(S_{C}\)</span> and <span class="math inline">\(L_{C}\)</span>. Depending on the model, a function of mean <span class="math inline">\(S_{C}\)</span> for a given <span class="math inline">\(L_{C}\)</span> (i.e., <span class="math inline">\(E(S_{C}|L_{C})\)</span> ) or mean <span class="math inline">\(L_{C}\)</span> for a given <span class="math inline">\(S_{C}\)</span> (i.e., <span class="math inline">\(E(L_{C}|S_{C})\)</span>) is used. These functions are not required to be linear, but often are, and in their linear form are represented as</p>
<p><span id="eq-ESL"><span class="math display">\[ E(S_{C}|L_{C})=a+bL_{C}  \tag{1}\]</span></span></p>
<p><span id="eq-ELS"><span class="math display">\[ E(L_{C}|S_{C})=c+dS_{C}  \tag{2}\]</span></span></p>
<p>Fitting these regressions is demonstrated <a href="#scale-length-relationships">below</a>.</p>
<p>&nbsp;</p>
</section>
<section id="common-back-calculation-models" class="level1 page-columns page-full">
<h1>Common Back-Calculation Models</h1>
<p>The first back-calculation model was jointly developed by Knut Dahl and Einar Lea and appeared in <span class="citation" data-cites="lea_methods_1910">Lea (<a href="#ref-lea_methods_1910" role="doc-biblioref">1910</a>)</span>. The underlying concept of the <em>Dahl-Lea model</em> is that growth of the calcified structure is in exact proportion to growth in length of the fish. With this, the ratio of <span class="math inline">\(S_{i}\)</span> to <span class="math inline">\(S_{C}\)</span> is the same as the ratio of <span class="math inline">\(L_{i}\)</span> to <span class="math inline">\(L_{C}\)</span>. Rearrangement of this equality yields the Dahl-Lea back-calculation model</p>
<p><span id="eq-DahlLea"><span class="math display">\[ L_{i}=\frac{S_{i}}{S_{C}}L_{C}  \tag{3}\]</span></span></p>
<p>The Dahl-Lea model describes a family of straight lines that pass through the <strong>origin</strong> and each observed (<span class="math inline">\(S_{C},L_{C}\)</span>) point. Visually (<a href="#fig-BackCalcEx704">Figure&nbsp;1</a>), the estimated <span class="math inline">\(L_{i}\)</span> for a particular fish is found by locating <span class="math inline">\(S_{i}\)</span> along the x-axis, moving vertically until the straight line for that fish is met, and then moving horizontally to the point on the y-axis.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="cell-output-display page-columns page-full">
<div id="fig-BackCalcEx704" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="backcalculation_files/figure-html/fig-BackCalcEx704-1.png" class="img-fluid figure-img" width="768"></p>
<p></p><figcaption class="figure-caption margin-caption">Figure&nbsp;1: Plot of length-at-capture versus scale radius for West Bearskin Lake Smallmouth Bass in 1990. All four methods of backcalculation are shown for fish 704 (<span class="math inline">\(S_{2}\)</span>=3.49804, <span class="math inline">\(L_{C}\)</span>=218, and <span class="math inline">\(S_{C}\)</span>=7.44389; black point and line) with calculational steps shown with the arrows. Fish 701 is shown as the gray point and line for comparative purposes.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><span class="citation" data-cites="fraser_growth_1916">Fraser (<a href="#ref-fraser_growth_1916" role="doc-biblioref">1916</a>)</span> was the first to describe, but <span class="citation" data-cites="lee_review_1920">Lee (<a href="#ref-lee_review_1920" role="doc-biblioref">1920</a>)</span> was the first to formally derive, the back-calculation model from the concept that “the growth <em>increment</em> of the scale is, on the average …, a constant proportion of the growth <em>increment</em> of the fish” <span class="citation" data-cites="francis_back-calculation_1990">(<a href="#ref-francis_back-calculation_1990" role="doc-biblioref">Francis 1990</a>)</span>. In practice, the <em>Fraser-Lee model</em> modified the Dahl-Lea model by adjusting for the length of the fish when the calcified structure forms (i.e., <span class="math inline">\(L=c\)</span> when <span class="math inline">\(S=0\)</span>), that is,</p>
<p><span id="eq-FraserLee"><span class="math display">\[ L_{i}=\frac{S_{i}}{S_{C}}(L_{C}-c)+c  \tag{4}\]</span></span></p>
<p>where <span class="math inline">\(c\)</span> comes from the length of the fish at the time of scale formation, the intercept of the length-scale relationship regression (e.g., from <a href="#eq-ELS">Equation&nbsp;2</a>), or from published “standards” for a species <span class="citation" data-cites="carlander_standard_1982">(<a href="#ref-carlander_standard_1982" role="doc-biblioref">Carlander 1982</a>)</span>. The Fraser-Lee model describes a family of lines with an intercept of <span class="math inline">\(c\)</span> that pass through the (<span class="math inline">\(S_{C},L_{C}\)</span>) point (<span class="citation" data-cites="francis_back-calculation_1990">Francis (<a href="#ref-francis_back-calculation_1990" role="doc-biblioref">1990</a>)</span>; <a href="#fig-BackCalcEx704">Figure&nbsp;1</a>).</p>
<p>The <em>scale proportional hypothesis</em> (SPH) model was named by <span class="citation" data-cites="francis_back-calculation_1990">Francis (<a href="#ref-francis_back-calculation_1990" role="doc-biblioref">1990</a>)</span>, but was first recognized by <span class="citation" data-cites="whitney_interpretation_1956">Whitney and Carlander (<a href="#ref-whitney_interpretation_1956" role="doc-biblioref">1956</a>)</span> when they said “<em>{i}f the scale was 10 per cent larger when the fish was caught than the average scale for that size of fish, [then] the scale would be 10 per cent larger than normal throughout the life.</em>” If “average” and “normal” are considered to be expected values, then this hypothesis can be written as</p>
<p><span class="math display">\[ \frac{S_{i}}{E[S|L_{i}]}=\frac{S_{C}}{E[S|L_{C}]} \]</span></p>
<p>If it is assumed that the scale-length relationship is linear, then the two expected values in these ratios are computed by plugging <span class="math inline">\(L_{i}\)</span> and <span class="math inline">\(L_{C}\)</span>, respectively, into the scale-length relationship (i.e., <a href="#eq-ESL">Equation&nbsp;1</a>) to produce</p>
<p><span class="math display">\[ \frac{S_{i}}{a+bL_{i}}=\frac{S_{C}}{a+bL_{C}} \]</span></p>
<p>which can be solved for <span class="math inline">\(L_{i}\)</span> to yield the general SPH back-calculation model</p>
<p><span id="eq-SPH"><span class="math display">\[ L_{i} = \frac{S_{i}}{S_{C}}\left(L_{C}+\frac{a}{b}\right) - \frac{a}{b}  \tag{5}\]</span></span></p>
<p>The linear SPH model produces a family of lines that all have an intercept of <span class="math inline">\(-\frac{a}{b}\)</span> and pass through each observed (<span class="math inline">\(S_{C},L_{C}\)</span>) point (<a href="#fig-BackCalcEx704">Figure&nbsp;1</a>). The SPH model is the same as the Fraser-Lee model except that the intercept from <a href="#eq-ELS">Equation&nbsp;2</a> is replaced with <span class="math inline">\(-\frac{a}{b}\)</span>. Further note that the SPH model is the same as the Dahl-Lea model if <span class="math inline">\(a=0\)</span>.</p>
<p>The <em>body proportional hypothesis</em> (BPH) model was also named by <span class="citation" data-cites="francis_back-calculation_1990">Francis (<a href="#ref-francis_back-calculation_1990" role="doc-biblioref">1990</a>)</span> and was also first recognized by <span class="citation" data-cites="whitney_interpretation_1956">Whitney and Carlander (<a href="#ref-whitney_interpretation_1956" role="doc-biblioref">1956</a>)</span> when they said “<em>{i}f a fish at time of capture were 10 per cent smaller than the average fish with that size of scale, [then] the fish would be 10 per cent smaller than the expected length for the size of that scale throughout life.</em>” This hypothesis can be written as</p>
<p><span class="math display">\[ \frac{L_{i}}{E[L|S_{i}]}=\frac{L_{C}}{E[L|S_{C}]} \]</span></p>
<p>If the length-scale relationship is linear then the expected values can be found by plugging <span class="math inline">\(S_{i}\)</span> and <span class="math inline">\(S_{c}\)</span> into <a href="#eq-ELS">Equation&nbsp;2</a> to get</p>
<p><span class="math display">\[ \frac{L_{i}}{c+dS_{i}}=\frac{L_{C}}{c+dS_{C}} \]</span></p>
<p>which can be solved for <span class="math inline">\(L_{i}\)</span> to yield the general BPH back-calculation model</p>
<p><span id="eq-BPH"><span class="math display">\[ L_{i}=L_{C}\frac{c+dS_{i}}{c+dS_{c}}  \tag{6}\]</span></span></p>
<p>The linear BPH model produces a family of lines that have an intercept of <span class="math inline">\(\frac{cL_{C}}{c+dS_{C}}\)</span> and pass through each observed (<span class="math inline">\(S_{C},L_{C}\)</span>) point (<a href="#fig-BackCalcEx704">Figure&nbsp;1</a>). In contrast to the other back-calculation models, the BPH model uses lines with a different intercept for each fish. The linear BPH model is the same as the Dahl-Lea model if <span class="math inline">\(c=0\)</span>.</p>
<div class="page-columns page-full"><p><span class="citation" data-cites="vigliola_back-calculation_2009">Vigliola and Meekan (<a href="#ref-vigliola_back-calculation_2009" role="doc-biblioref">2009</a>)</span> described 18 other models for the back-calculation of fish length.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p><div class="no-row-height column-margin column-container"><li id="fn2"><p><sup>2</sup>&nbsp;Functions for each of these models can be created with <code>bcFuns()</code> from <code>RFishBC</code>.</p></li></div></div>
<p>&nbsp;</p>
</section>
<section id="data-organization-manipulation" class="level1 page-columns page-full">
<h1>Data Organization &amp; Manipulation</h1>
<div class="page-columns page-full"><p>In <em>wide</em> or <em>one-fish-per-line</em> format, all information about a single fish, including all of the measurements from the calcified structure, is in one row of the data frame. <code>wb90</code> contains radial measurements in the wide format.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p><div class="no-row-height column-margin column-container"><li id="fn3"><p><sup>3</sup>&nbsp;See the data frame snippet <a href="#data">above</a>.</p></li></div></div>
<p>For back-calculation of fish length, these data must be radial, and not incremental, measurements. If <code>wb90</code> had contained incremental measurements, then it could be converted to radial measurements with <code>gConvert()</code> from <code>RFishBC</code>. The <code>gConvert()</code> function requires the data frame with the incremental measurements as the first argument, the prefix (in quotes) for the columns that contain the incremental measurements in <code>in.pre=</code>, and the type of measurement to <strong>convert to</strong> in <code>out.type=</code> (the options are <code>"rad"</code> (the default) or <code>"inc"</code>). For example, the code below would create a new data frame from <code>wb90</code> with radial measurements (<strong>IF</strong> <code>wb90</code> had incremental measurements).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NOT RUN because wb90 is already radial measurements</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>wb90A <span class="ot">&lt;-</span> RFishBC<span class="sc">::</span><span class="fu">gConvert</span>(wb90,<span class="at">in.pre=</span><span class="st">"anu"</span>,<span class="at">out.type=</span><span class="st">"rad"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="page-columns page-full"><p>For efficient back-calculation, the data must also be converted to <em>long</em> or <em>one-measurement-per-line</em> format. Wide data may be converted to long data with <code>pivot_longer()</code> from <code>tidyr</code>.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> For this use, the variables that contain the radial measurement data are given to <code>cols=</code>. The names for these variables will form a new column in the resulting data frame with the name given in <code>names_to=</code>. The values for these variables will be in a new column with the name given in <code>values_to=</code>.</p><div class="no-row-height column-margin column-container"><li id="fn4"><p><sup>4</sup>&nbsp;<span class="citation" data-cites="ogleIntroductoryFisheriesAnalyses2016">Ogle (<a href="#ref-ogleIntroductoryFisheriesAnalyses2016" role="doc-biblioref">2016</a>)</span> used <code>gather()</code> from <code>tidyr</code> for this same purpose. The maintainers of <code>tidyr</code> suggest using <code>pivot_longer()</code> rather than <code>gather</code>.</p></li></div></div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>wb90r <span class="ot">&lt;-</span> wb90 <span class="sc">|&gt;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols=</span>anu1<span class="sc">:</span>anu9,<span class="at">names_to=</span><span class="st">"agei"</span>,<span class="at">values_to=</span><span class="st">"radi"</span>) <span class="sc">|&gt;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(fish,agei)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">headtail</span>(wb90r)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#R|       yearcap fish agecap lencap  radcap agei    radi
#R|  1       1990  374      7    243 7.57375 anu1 1.01672
#R|  2       1990  374      7    243 7.57375 anu2 2.39296
#R|  3       1990  374      7    243 7.57375 anu3 3.47635
#R|  1627    1990  998      7    298 8.54805 anu7 8.54805
#R|  1628    1990  998      7    298 8.54805 anu8      NA
#R|  1629    1990  998      7    298 8.54805 anu9      NA</code></pre>
</div>
</div>
<p>As noted in <span class="citation" data-cites="ogleIntroductoryFisheriesAnalyses2016">Ogle (<a href="#ref-ogleIntroductoryFisheriesAnalyses2016" role="doc-biblioref">2016</a>)</span>, there are three potential problems with this result. First, the new <code>agei</code> variable contains the names of the variables from the original wide format data frame (e.g., <code>anu1</code>, <code>anu2</code>) rather than numbers that correspond to the age that the annulus was formed. Converting these labels to numbers begins by finding the portion of the string after the “anu” prefix with <code>str_sub()</code> with the vector of names as the first argument and <code>start=4</code> (because “anu” is three characters long). The result from <code>str_sub()</code>, however, is a character that must then be converted to a numeric with <code>as.numeric()</code>.</p>
<p>The second problem is that several of the radial measurements contain <code>NA</code> values. The non-<code>NA</code> values are found and retained by using <code>!is.na()</code> within <code>filter()</code>.</p>
<p>The third problem, while not an issue with these particular data, is that “plus growth” may have been recorded. “Plus growth” is growth on the margin of the calcified structure that does not represent a complete year of growth. If “plus growth” is present, then the new <code>agei</code> variable will have a value greater than the age-at-capture value. These instances should be removed from the new long format data frame.</p>
<p>The following code adjusts for these three issues.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>wb90r <span class="ot">&lt;-</span> wb90r <span class="sc">|&gt;</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">agei=</span><span class="fu">as.numeric</span>(stringr<span class="sc">::</span><span class="fu">str_sub</span>(agei,<span class="at">start=</span><span class="dv">4</span>))) <span class="sc">|&gt;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(radi)) <span class="sc">|&gt;</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(agei<span class="sc">&lt;=</span>agecap)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">peek</span>(wb90r,<span class="at">n=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#R|      yearcap fish agecap lencap  radcap agei    radi
#R|  1      1990  374      7    243 7.57375    1 1.01672
#R|  85     1990  388      9    300 9.38096    8 8.08080
#R|  170    1990  408      3    136 3.12974    3 3.12974
#R|  256    1990  436      3    154 4.27702    1 1.46016
#R|  341    1990  460      2    115 2.66954    2 2.66954
#R|  426    1990  698      7    264 7.76545    3 3.62943
#R|  511    1990  714      7    290 9.31498    2 2.89488
#R|  597    1990  730      2     98 2.24291    1 1.21677
#R|  682    1990  747      7    265 7.84295    7 7.84295
#R|  767    1990  998      7    298 8.54805    7 8.54805</code></pre>
</div>
</div>
<p>&nbsp;</p>
</section>
<section id="computing-back-calculated-lengths" class="level1">
<h1>Computing Back-Calculated Lengths</h1>
<section id="scale-length-relationships" class="level2">
<h2 class="anchored" data-anchor-id="scale-length-relationships">Scale-Length Relationships</h2>
<p>The scale-length (<a href="#eq-ESL">Equation&nbsp;1</a>) and length-scale (<a href="#eq-ELS">Equation&nbsp;2</a>) relationships required for all but the Dahl-Lea method are computed with the wide format data. Thus, the wide format data frame must contain the length of the fish (e.g., <code>lencap</code>) and the total radius of the calcified structure (e.g., <code>radcap</code>) at the time of capture. Both linear relationships are fit with <code>lm()</code> and the coefficients should be extracted with <code>coef()</code> and saved into objects.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>lm.sl <span class="ot">&lt;-</span> <span class="fu">lm</span>(radcap<span class="sc">~</span>lencap,<span class="at">data=</span>wb90)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>( a <span class="ot">&lt;-</span> <span class="fu">coef</span>(lm.sl)[[<span class="dv">1</span>]] )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#R|  [1] -1.304391</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>( b <span class="ot">&lt;-</span> <span class="fu">coef</span>(lm.sl)[[<span class="dv">2</span>]] )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#R|  [1] 0.03537477</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>lm.ls <span class="ot">&lt;-</span> <span class="fu">lm</span>(lencap<span class="sc">~</span>radcap,<span class="at">data=</span>wb90)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>( c <span class="ot">&lt;-</span> <span class="fu">coef</span>(lm.ls)[[<span class="dv">1</span>]] )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#R|  [1] 41.65166</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>( d <span class="ot">&lt;-</span> <span class="fu">coef</span>(lm.ls)[[<span class="dv">2</span>]] )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#R|  [1] 27.35597</code></pre>
</div>
</div>
</section>
<section id="applying-the-back-calculation-models" class="level2">
<h2 class="anchored" data-anchor-id="applying-the-back-calculation-models">Applying the Back-Calculation Models</h2>
<p>The <span class="math inline">\(L_{i}\)</span> estimated with a back-calculation model are most easily added to the long format data frame with <code>mutate()</code>. For example, the <span class="math inline">\(L_{i}\)</span> computed with all four back-calculation models are added to <code>wb90r</code> below.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>wb90r <span class="ot">&lt;-</span> wb90r <span class="sc">|&gt;</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DL.len=</span>(radi<span class="sc">/</span>radcap)<span class="sc">*</span>lencap,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">FL.len=</span>(radi<span class="sc">/</span>radcap)<span class="sc">*</span>(lencap<span class="sc">-</span>c)<span class="sc">+</span>c,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">SPH.len=</span>(<span class="sc">-</span>a<span class="sc">/</span>b)<span class="sc">+</span>(lencap<span class="sc">+</span>a<span class="sc">/</span>b)<span class="sc">*</span>(radi<span class="sc">/</span>radcap),</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">BPH.len=</span>lencap<span class="sc">*</span>(c<span class="sc">+</span>d<span class="sc">*</span>radi)<span class="sc">/</span>(c<span class="sc">+</span>d<span class="sc">*</span>radcap))</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">headtail</span>(wb90r,<span class="at">n=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#R|      yearcap fish agecap lencap  radcap agei    radi    DL.len    FL.len
#R|  1      1990  374      7    243 7.57375    1 1.01672  32.62096  68.68119
#R|  2      1990  374      7    243 7.57375    2 2.39296  76.77693 105.26856
#R|  3      1990  374      7    243 7.57375    3 3.47635 111.53696 134.07052
#R|  4      1990  374      7    243 7.57375    4 4.37718 140.43964 158.01910
#R|  5      1990  374      7    243 7.57375    5 5.18976 166.51087 179.62156
#R|  763    1990  998      7    298 8.54805    3 3.60701 125.74669 149.82265
#R|  764    1990  998      7    298 8.54805    4 4.48222 156.25804 176.06941
#R|  765    1990  998      7    298 8.54805    5 5.17646 180.46047 196.88905
#R|  766    1990  998      7    298 8.54805    6 6.62240 230.86847 240.25149
#R|  767    1990  998      7    298 8.54805    7 8.54805 298.00000 298.00000
#R|        SPH.len   BPH.len
#R|  1    64.54444  67.83504
#R|  2   102.00007 104.60001
#R|  3   131.48552 133.54177
#R|  4   156.00243 157.60660
#R|  5   178.11753 179.31392
#R|  763 147.06071 151.78969
#R|  764 173.79670 177.68803
#R|  765 195.00440 198.23129
#R|  766 239.17509 241.01809
#R|  767 298.00000 298.00000</code></pre>
</div>
</div>
<p>For example, the mean length-at-age may be computed from the back-calculated lengths (shown below for the Fraser-Lee results).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>wb90r <span class="sc">|&gt;</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(agei) <span class="sc">|&gt;</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">validn</span>(FL.len),<span class="at">mn=</span><span class="fu">mean</span>(FL.len),<span class="at">sd=</span><span class="fu">sd</span>(FL.len)) <span class="sc">|&gt;</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#R|    agei   n       mn        sd
#R|  1    1 181  78.5663  6.472692
#R|  2    2 178 114.1527 10.453632
#R|  3    3 155 146.7669 13.898434
#R|  4    4  71 172.6512 15.339848
#R|  5    5  64 201.0405 17.479717
#R|  6    6  64 235.3834 23.350527
#R|  7    7  50 268.5969 25.286958
#R|  8    8   2 283.2237 26.912010
#R|  9    9   2 314.5000 20.506097</code></pre>
</div>
</div>
<p>Additionally, the mean length at each back-calculated age computed separately for each age-at-capture may be computed with <code>sumTable()</code> from <code>FSA</code>, where the left side of the formula is the quantitative variable to be summarized and the right side has grouping variables presented in <code>row*column</code> format.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sumTable</span>(FL.len<span class="sc">~</span>agecap<span class="sc">*</span>agei,<span class="at">data=</span>wb90r,<span class="at">digits=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#R|       1     2     3     4     5     6     7     8     9
#R|  1 73.7    NA    NA    NA    NA    NA    NA    NA    NA
#R|  2 79.7 113.3    NA    NA    NA    NA    NA    NA    NA
#R|  3 77.3 112.8 148.9    NA    NA    NA    NA    NA    NA
#R|  4 71.3 121.8 160.9 194.0    NA    NA    NA    NA    NA
#R|  6 79.8 107.9 136.0 169.6 198.8 229.7    NA    NA    NA
#R|  7 81.6 118.2 144.7 170.7 201.8 237.0 269.1    NA    NA
#R|  9 71.2  99.8 135.0 166.1 197.5 236.0 256.4 283.2 314.5</code></pre>
</div>
</div>



</section>
</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-carlander_standard_1982" class="csl-entry" role="doc-biblioentry">
Carlander, K. D. 1982. Standard intercepts for calculating lengths from scale measurements for some centrarchid and percid fishes. Transactions of the American Fisheries Society 111:332–336.
</div>
<div id="ref-francis_back-calculation_1990" class="csl-entry" role="doc-biblioentry">
Francis, R. I. C. C. 1990. Back-calculation of fish length: A critical review. Journal of Fish Biology 36:883–902.
</div>
<div id="ref-fraser_growth_1916" class="csl-entry" role="doc-biblioentry">
Fraser, C. McL. 1916. Growth of the spring salmon. Transactions of the Pacific Fisheries Society 1915:29–39.
</div>
<div id="ref-lea_methods_1910" class="csl-entry" role="doc-biblioentry">
Lea, E. 1910. On the methods used in the <span>Herring</span>-investigations. Publ. Circonst. Cons. perm. int. Explor. Mer 108(1):14–22.
</div>
<div id="ref-lee_review_1920" class="csl-entry" role="doc-biblioentry">
Lee, R. M. 1920. A review of the methods of age and growth determination in fishes by means of scales. Fisheries Investigations, London Series 2 4((2)):1–32.
</div>
<div id="ref-ogleIntroductoryFisheriesAnalyses2016" class="csl-entry" role="doc-biblioentry">
Ogle, D. H. 2016. <a href="http://derekogle.com/IFAR/book/">Introductory <span>Fisheries</span> <span>Analyses</span> with <span>R</span></a>. CRC Press, Boca Raton, FL.
</div>
<div id="ref-vigliola_back-calculation_2009" class="csl-entry" role="doc-biblioentry">
Vigliola, L., and M. G. Meekan. 2009. The back-calculation of fish growth from otoliths. Pages 174–211 <em>in</em> B. S. Green, B. D. Mapstone, G. Carlos, and G. A. Begg, editors. Tropical <span>Fish</span> <span>Otoliths</span>: <span>Information</span> for <span>Assessment</span>, <span>Management</span>, and <span>Ecology</span>. Springer.
</div>
<div id="ref-weisberg_using_1993" class="csl-entry" role="doc-biblioentry">
Weisberg, S. 1993. Using hard-part increment data to estimate age and environmental effects. Canadian Journal of Fisheries and Aquatic Sciences 50(6):1229–1237.
</div>
<div id="ref-whitney_interpretation_1956" class="csl-entry" role="doc-biblioentry">
Whitney, R. R., and K. D. Carlander. 1956. Interpretation of body-scale regression for computing body length of fish. Journal of Wildlife Management 20:21–27.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp(/https:\/\/droglenc\.github\.io\/IFAR\//);
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script>
</div> <!-- /content -->



<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>