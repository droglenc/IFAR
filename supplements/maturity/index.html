<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Derek H. Ogle" />


<title>Recruitment</title>

<script src="index_files/jquery-1.11.0/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="index_files/bootstrap-3.3.1/css/bootstrap.min.css" rel="stylesheet" />
<script src="index_files/bootstrap-3.3.1/js/bootstrap.min.js"></script>
<script src="index_files/bootstrap-3.3.1/shim/html5shiv.min.js"></script>
<script src="index_files/bootstrap-3.3.1/shim/respond.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<link rel="stylesheet"
      href="index_files/highlight/default.css"
      type="text/css" />
<script src="index_files/highlight/highlight.js"></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img { 
  max-width:100%; 
  height: auto; 
}
</style>
<div class="container-fluid main-container">


<div id="header">
<h1 class="title">Recruitment</h1>
<h3 class="subtitle"><em>Maturity Analyses</em></h3>
<h4 class="author"><em>Derek H. Ogle</em></h4>
</div>


<hr />
<ul>
<li><a href="#data-used-in-this-supplement">Data Used in this Supplement</a></li>
<li><a href="#maturity-data">Maturity Data</a></li>
<li><a href="#modeling-with-raw-data">Modeling with Raw Data</a>
<ul>
<li><a href="#fitting-the-logistic-regression-model">Fitting the Logistic Regression Model</a></li>
<li><a href="#length-or-age-at-maturity">Length- or Age-at-Maturity</a></li>
</ul></li>
<li><a href="#modeling-with-summarized-data">Modeling with Summarized Data</a></li>
<li><a href="#comparing-logistic-regressions-between-groups">Comparing Logistic Regressions Between Groups</a></li>
</ul>
<hr />
<p>The length-, weight-, or age-at-maturity is important to monitor for fish populations because these metrics are closely tied to reproductive potential and respond to density-depencent and resource changes <span class="citation">(Pope et al. 2010)</span>. Methods for modeling the relationship between maturity stage and length is demonstrated in this supplement. Results from these modeled relationships are then used to calculate metrics such as length at 50% maturity. These methods extend directly to use with age or weight data.</p>
<div id="required-packages-for-this-supplement" class="section level3">
<h3>Required Packages for this Supplement</h3>
<p>Functions used in this supplement require the packages shown below.</p>
<pre class="r"><code>&gt; library(FSA)
&gt; library(magrittr)
&gt; library(dplyr)
&gt; library(lubridate)
&gt; library(car)</code></pre>
</div>
<div id="data-used-in-this-supplement" class="section level3">
<h3>Data Used in this Supplement</h3>
<p>The total length (<code>length</code>; to the nearest cm), <code>age</code> (years), and <code>maturity</code> (<code>Immature</code> and <code>Mature</code>) state of female Yelloweye Rockfish (<em>Sebastes rubberimus</em>) collected from along the Oregon coast are recorded in <code>YERockFish.csv</code> (<a href="https://github.com/droglenc/FSAdata/blob/master/data-raw/YERockfish.csv">view</a>, <a href="https://raw.githubusercontent.com/droglenc/FSAdata/master/data-raw/YERockfish.csv">download</a>, <a href="http://derekogle.com/fishR/data/data-html/YERockfish.html">meta-data</a>).</p>
<pre class="r"><code>&gt; df &lt;- read.csv(&quot;YERockfish.csv&quot;)
&gt; str(df)</code></pre>
<pre><code>&#39;data.frame&#39;:   158 obs. of  5 variables:
 $ date    : Factor w/ 71 levels &quot;10/1/2003&quot;,&quot;10/2/2003&quot;,..: 66 9 38 25 60 6 3..
 $ length  : int  31 32 32 32 32 33 33 34 34 34 ...
 $ age     : int  10 6 11 11 13 9 10 8 10 11 ...
 $ maturity: Factor w/ 2 levels &quot;Immature&quot;,&quot;Mature&quot;: 1 1 1 1 1 1 1 1 1 1 ...
 $ stage   : Factor w/ 9 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 1 1 1 2 2 1 1 1 1 1 ...</code></pre>
<p>The date of capture was also recorded. For a later example that compares the maturity analysis between two groups, a new variable that indicates whether the fish was captured before 2002 or in 2002 and after is needed. This conversion requires that the <code>date</code> variable be converted to a format that R recognizes as a date. The <code>as.POSIXct()</code> function does this conversion taking the original dates as its first argument and a <code>format=</code> argument that describes the format of the dates in the original varible. The format argument takes a string where <code>%m</code> represents the month as a number (<code>%b</code> would be the abbreviated month name), <code>%d</code> is the day of the month, and <code>%Y</code> is the four-digit year (<code>%y</code> is the year without the century). These format codes are then separated by characters that separate the fields in the original dates. See <code>?strptime</code> for more format codes.</p>
<pre class="r"><code>&gt; df %&lt;&gt;% mutate(date=as.POSIXct(date,format=&quot;%m/%d/%Y&quot;))
&gt; str(df)</code></pre>
<pre><code>&#39;data.frame&#39;:   158 obs. of  5 variables:
 $ date    : POSIXct, format: &quot;2003-09-02&quot; &quot;2002-10-07&quot; ...
 $ length  : int  31 32 32 32 32 33 33 34 34 34 ...
 $ age     : int  10 6 11 11 13 9 10 8 10 11 ...
 $ maturity: Factor w/ 2 levels &quot;Immature&quot;,&quot;Mature&quot;: 1 1 1 1 1 1 1 1 1 1 ...
 $ stage   : Factor w/ 9 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 1 1 1 2 2 1 1 1 1 1 ...</code></pre>
<p>The year of captured is then extracted with <code>year()</code> from <code>lubridate</code>. Note that the month could be extracted with <code>month()</code>, day of the month with <code>mday()</code>, and day of the year (1-366) with <code>yday()</code>. The <code>pre02</code> variable may then be added to the data.frame.</p>
<pre class="r"><code>&gt; df %&lt;&gt;% mutate(year=year(date),
                 era=factor(ifelse(year&lt;2002,&quot;pre-2002&quot;,&quot;2002 and after&quot;)))
&gt; headtail(df)</code></pre>
<pre><code>          date length age maturity stage year            era
1   2003-09-02     31  10 Immature     1 2003 2002 and after
2   2002-10-07     32   6 Immature     1 2002 2002 and after
3   2000-07-18     32  11 Immature     1 2000       pre-2002
156 2002-08-18     67  50   Mature     6 2002 2002 and after
157 2002-10-07     68  88   Mature     6 2002 2002 and after
158 2001-04-23     70  66   Mature     4 2001       pre-2002</code></pre>
<p>Finally, <code>maturity</code> was not recorded for several individuals. These individuals were removed from further analysis.</p>
<pre class="r"><code>&gt; df %&lt;&gt;% filter(!is.na(maturity))</code></pre>
</div>
<div id="maturity-data" class="section level2">
<h2>Maturity Data</h2>
<p>Raw maturity data generally consists of a maturity statement (either “mature”&quot; or “immature”“), size (length or weight), age, sex, and other variables as needed (e.g., capture date, capture location) recorded for individual fish. The maturity variable may need to be derived from more specific data about the”stage of maturation&quot; recorded for each fish. Often, maturity will be recorded as a dummy or indicator variable – “0” for immature and a “1” for mature – but this is not required for most modern software. Sex is an important variable to record as maturity should be analyzed separately for each sex.</p>
<p>Summarized maturity data consists of the proportion of individuals that are mature within each age or length category. Age categories are generally the recorded ages, whereas recorded lengths are often categorized into bins. Age or length categories should be as narrow as possible but include enough individuals such that the proportion mature in each bin is reliably estimated.</p>
<p>In this supplement, the total length of the rockfish was measured to the nearest cm. Length categories of 2 cm were chosen to summarize the data so that reasonable sample sizes (<span class="math">\(&gt;10\)</span> fish) in the length range where the proportion of mature fish is most rapidly changing. These length categories are added to the data.frame with <code>lencat()</code> below.</p>
<pre class="r"><code>&gt; df %&lt;&gt;% mutate(lcat2=lencat(length,w=2))
&gt; headtail(df)</code></pre>
<pre><code>          date length age maturity stage year            era lcat2
1   2003-09-02     31  10 Immature     1 2003 2002 and after    30
2   2002-10-07     32   6 Immature     1 2002 2002 and after    32
3   2000-07-18     32  11 Immature     1 2000       pre-2002    32
146 2002-08-18     67  50   Mature     6 2002 2002 and after    66
147 2002-10-07     68  88   Mature     6 2002 2002 and after    68
148 2001-04-23     70  66   Mature     4 2001       pre-2002    70</code></pre>
<p>The frequency of mature and immature fish in each length category is computed with <code>xtabs()</code> below. The raw frequencies are converted to a “row proportions” table to see the proportion of fish within each length bin that are mature. Finally, a plot of the percentage of mature fish is constructed (Figure 1).</p>
<pre class="r"><code>&gt; freq &lt;- xtabs(~lcat2+maturity,data=df)
&gt; props &lt;- prop.table(freq,margin=1)
&gt; round(props,1)   # for display only</code></pre>
<pre><code>     maturity
lcat2 Immature Mature
   30      1.0    0.0
   32      1.0    0.0
   34      1.0    0.0
   36      0.6    0.4
   38      0.6    0.4
   40      0.3    0.7
   42      0.1    0.9
   44      0.1    0.9
   46      0.0    1.0
   48      0.1    0.9
   50      0.0    1.0
   52      0.0    1.0
   54      0.0    1.0
   56      0.0    1.0
   58      0.0    1.0
   60      0.0    1.0
   62      0.0    1.0
   64      0.0    1.0
   66      0.0    1.0
   68      0.0    1.0
   70      0.0    1.0</code></pre>
<pre class="r"><code>&gt; plot(props[,&quot;Mature&quot;]~as.numeric(rownames(props)),pch=19,
       xlab=&quot;Total Length (cm)&quot;,ylab=&quot;Proportion Mature&quot;)</code></pre>
<p><img src="index_files/figure-html/sumLength-1.png" title="" alt="" width="336" /></p>
<p>Figure 1: Proportion of female Yelloweye Rockfish that were mature at each 2-cm length category.</p>
<p>These results show that the percentage of mature female Yellow Rockfish increases quickly between 34 and 42 cm.</p>
<p>   </p>
</div>
<div id="modeling-with-raw-data" class="section level2">
<h2>Modeling with Raw Data</h2>
<div id="fitting-the-logistic-regression-model" class="section level3">
<h3>Fitting the Logistic Regression Model</h3>
<p>Raw maturity data is generally summarized with a logistic regression. A logistic regression is conducted with a binomial response variable and, generally, a quantitative explanatory variable. The logistic regression would like to use typical general linear model theory to model the probability of “success” (<span class="math">\(p\)</span>) by the value of the explanatory variable. However, this relationship is generally not linear (primarily due to the constaint that the probability is between 0 and 1). Thus, the logistic regression procedure must transform <span class="math">\(p\)</span> to form a linear equation. The required transformation is the <em>logit</em> transformation,</p>
<p><span class="math">\[ logit(p) = log\left(\frac{p}{1-p}\right) \]</span></p>
<p>where <span class="math">\(1-p\)</span> is the probability of “failure.” In maturity analyses a “success” is defined as “being mature” and a “failure” is defined as “being immature.” With this transformation a linear model is formed with</p>
<p><span class="math">\[ logit(p) = log\left(\frac{p}{1-p}\right) = \alpha + \beta_{1}X \]</span></p>
<p>where the explanatory variable, <span class="math">\(X\)</span>, is often length or age. Thus, in this application, the logistic regression is modeling the probability of being mature as a function of length or age.</p>
<p>The logistic regression is fit with <code>glm()</code> with the first argument a formula of the form <code>factor~quant</code>, where <code>factor</code> and <code>quant</code> generically reprsent factor and quantitative variables respectively. The data frame that contains <code>factor</code> and <code>quant</code> must be given to <code>data=</code>. Finally, <code>glm()</code> is forced to fit a logistic regression by including <code>family=binomial</code>.</p>
<pre class="r"><code>&gt; glm1 &lt;- glm(maturity~length,data=df,family=binomial)</code></pre>
<p>Parameters estimates are extracted with <code>coef()</code>. Confidence intervals for the parameters of a logistic regression are best estiamted with bootstrapping (rather than normal theory). Bootstrapping is performed with <code>bootCase()</code> from <code>car</code> as described in Chapter X.</p>
<pre class="r"><code>&gt; bcL &lt;- bootCase(glm1,B=100)  # B should be nearer to 1000
&gt; cbind(Ests=coef(glm1),confint(bcL))</code></pre>
<pre><code>                   Ests     95% LCI     95% UCI
(Intercept) -16.9482593 -30.0233488 -12.5151964
length        0.4371786   0.3211833   0.7720124</code></pre>
<p>A predicted probability of “success” (i.e., being mature) at a given value of the explanatory variable (<span class="math">\(x\)</span>) is computed with</p>
<p><span class="math">\[ p = \frac{e^{\alpha + \beta_{1}x}}{1+e^{\alpha + \beta_{1}}} \quad \quad \quad \quad \text{(1)} \]</span></p>
<p>This prediction is computed with <code>predict()</code>, which requires the <code>glm</code> object as the first argument, a data.frame with the values of the explanatory variable for which to make the prediction as the second argument, and <code>type=&quot;response&quot;</code> (which forces the prediction of the probability of being mature rather than the logit). For example, the predicted probabilities of being mature for female Yelloweye Rockfish that are 32- and 42-cm total length are computed below.</p>
<pre class="r"><code>&gt; predict(glm1,data.frame(length=c(32,42)),type=&quot;response&quot;)</code></pre>
<pre><code>        1         2 
0.0493342 0.8042766 </code></pre>
<p>Confidence intervals for the predicted probability are formed by computing the prediction for each bootstrap sample and then extracting the values for the upper and lower 2.5% of these predictions. This process is most easily accomplished by forming a function that represents Equation 1 and then using <code>apply()</code> to apply that function to each row of the matrix containing the bootstrap samples. This is the same process as described for XXX in Chapter X. The code below computes the 95% confidence intervals for the predicted probability of being mature for 32-cm long Yelloweye Rockfish.</p>
<pre class="r"><code>&gt; predP &lt;- function(cf,x) exp(cf[1]+cf[2]*x)/(1+exp(cf[1]+cf[2]*x))
&gt; p32 &lt;- apply(bcL,1,predP,x=32)
&gt; quantile(p32,c(0.025,0.975))</code></pre>
<pre><code>       2.5%       97.5% 
0.005483389 0.122981080 </code></pre>
<p>A plot that illustrates the fit of the logistic regression (Figure 2) can be constructed in several steps. First, a base plot that depicts the raw data is constructed. This plot is constructed below. Take special note that <code>maturity</code> was forced to be numeric between 0 and 1 for the plot and transparent points (as described in Chapter 3) were used because there is considerable overplotting with the “discrete” maturity and length data.</p>
<pre class="r"><code>&gt; plot((as.numeric(maturity)-1)~length,data=df,
       pch=19,col=rgb(0,0,0,1/8),
       xlab=&quot;Total Length (cm)&quot;,ylab=&quot;Proportion Mature&quot;)</code></pre>
<p>Second, the proportion mature for each 2-cm length bin are added with <code>points()</code>.</p>
<pre class="r"><code>&gt; points(props[,&quot;Mature&quot;]~as.numeric(rownames(props)),pch=3)</code></pre>
<p>Finally, the fitted line from the logistic regression is added by first using the <code>glm()</code> object to predict the probability of being mature for lengths that span the range of observed lengths and then plotting these points as a line with <code>lines()</code>.</p>
<pre class="r"><code>&gt; lens &lt;- seq(30,70,length.out=99)
&gt; preds &lt;- predict(glm1,data.frame(length=lens),type=&quot;response&quot;)
&gt; lines(preds~lens,lwd=2)</code></pre>
<p><img src="index_files/figure-html/LogisticFit1-1.png" title="" alt="" width="336" /></p>
<p>Figure 2: Fitted logistic regression for proportion of female Yelloweye Rockfish mature by total length.</p>
<p>   </p>
</div>
<div id="length--or-age-at-maturity" class="section level3">
<h3>Length- or Age-at-Maturity</h3>
<p>A common metric in fisheries science is to find the length or age at which a certain percentage of the fish are mature. For example, it is common to ask “what is the length or age at which 50% of the fish have reached maturity?”&quot; A general formula for computing this metric is found by solving <code>r</code> for <span class="math">\(X\)</span>.</p>
<p><span class="math">\[ x = \frac{log\left(\frac{p}{1-p}\right)-\alpha}{\beta_{1}} \quad \quad \quad \quad \text{(2)} \]</span></p>
<p>In the common case of finding <span class="math">\(X\)</span> for 50% maturity (i.e., <span class="math">\(p=0.5\)</span>), Equation 2 reduces to</p>
<p><span class="math">\[ x = -\frac{\alpha}{\beta_{1}} \quad \quad \quad \quad \text{(3)} \]</span></p>
<p>The age at which 50% of the fish are mature is commonly symbolized as <span class="math">\(A_{50}\)</span>. Similarly, the length at which 90% of the fish are mature would be <span class="math">\(L_{90}\)</span>.</p>
<p>These calculations are simplified by creating a function to perform Equation 2 as follows</p>
<pre class="r"><code>&gt; lrPerc &lt;- function(cf,p) (log(p/(1-p))-cf[[1]])/cf[[2]]</code></pre>
<p>This functions takes the coefficents from the <code>glm()</code> object as the first argument and the probability of interest (<span class="math">\(p\)</span>) as the second argument. Thus, the lengths at which 50% and 90% of the female Yelloweye Rockfish are mature are computed below.</p>
<pre class="r"><code>&gt; ( L50 &lt;- lrPerc(coef(glm1),0.5) )</code></pre>
<pre><code>[1] 38.76736</code></pre>
<pre class="r"><code>&gt; ( L90 &lt;- lrPerc(coef(glm1),0.9) )</code></pre>
<pre><code>[1] 43.79328</code></pre>
<p>Confidence intervals for these values are constructed from the bootstrap samples, similar to what was illustrated above for predicted values.</p>
<pre class="r"><code>&gt; bL50 &lt;- apply(bcL,1,lrPerc,p=0.5)
&gt; ( L50ci &lt;- quantile(bL50,c(0.025,0.975)) )</code></pre>
<pre><code>    2.5%    97.5% 
37.64591 39.69301 </code></pre>
<pre class="r"><code>&gt; bL90 &lt;- apply(bcL,1,lrPerc,p=0.9)
&gt; ( L90ci &lt;- quantile(bL90,c(0.025,0.975)) )</code></pre>
<pre><code>    2.5%    97.5% 
41.72979 45.82816 </code></pre>
<p>The calculation of the <span class="math">\(L_{50}\)</span> may be illustrated on a fitted-line plot (Figure 3) by adding the code below to the code above used to construct Figure 2.</p>
<pre class="r"><code>&gt; lines(c(0,L50),c(0.5,0.5),lty=2,lwd=2,col=&quot;red&quot;)
&gt; lines(c(L50,L50),c(-0.2,0.5),lty=2,lwd=2,col=&quot;red&quot;)</code></pre>
<p><img src="index_files/figure-html/LogisticFit2-1.png" title="" alt="" width="336" /></p>
<p>Figure 3: Fitted logistic regression for proportion of female Yelloweye Rockfish mature by total length with <span class="math">\(L_{50}\)</span> shown.</p>
<p>   </p>
</div>
</div>
<div id="modeling-with-summarized-data" class="section level2">
<h2>Modeling with Summarized Data</h2>
<p>Sometimes maturity data is presented in summarized format – that is, the proportion of fish for each length that were mature. Such data can be computed from the original data.frame with the code below. Note that there are two “tricks” in this code. First, the <code>maturity</code> factor variable is coerced to be a numeric variable, but 1 is subtracted from this result because values of 1 for immature and 2 for mature are returned. Second, the mean of this result is the proportion of ones in the data, which is the proportion of mature fish.</p>
<pre class="r"><code>&gt; df2 &lt;- df %&gt;%
    group_by(length) %&gt;%
    summarize(pmat=mean(as.numeric(maturity)-1),
              n=n()) %&gt;%
    as.data.frame()
&gt; headtail(df2)</code></pre>
<pre><code>   length pmat n
1      31    0 1
2      32    0 4
3      33    0 2
33     67    1 1
34     68    1 1
35     70    1 1</code></pre>
<p>Also note that this code is only used here to produce data to illustrate how to analyze summarized data. If one has raw data as in <code>YERockfish</code>, then the methods of the previous section should be used, though the technique used here provides identical answers.</p>
<p>The appropriate logistic regression model is again fit with . However, the left side of the formula is the proportion of “successes” variable and  is set equal to the sample size used to compute each proportion. Once the model is fit, the same extractor functions can be used to summarize the results. [<em>Note that <code>glm()</code> and <code>bootCase()</code> will return a warning about non-integer number of successes when used in this way.</em>]</p>
<pre class="r"><code>&gt; glm2 &lt;- glm(pmat~length,data=df2,family=binomial,weights=n)
&gt; bcL2 &lt;- bootCase(glm2,B=100)  # B should be closer to 1000
&gt; cbind(Ests=coef(glm2),confint(bcL2))</code></pre>
<pre><code>                   Ests     95% LCI     95% UCI
(Intercept) -16.9482593 -25.3045732 -11.4874407
length        0.4371786   0.3032473   0.6471767</code></pre>
<pre class="r"><code>&gt; predict(glm2,data.frame(length=c(32,42)),type=&quot;response&quot;)</code></pre>
<pre><code>        1         2 
0.0493342 0.8042766 </code></pre>
<pre class="r"><code>&gt; p32a &lt;- apply(bcL2,1,predP,x=32)
&gt; quantile(p32a,c(0.025,0.975))</code></pre>
<pre><code>      2.5%      97.5% 
0.00976349 0.14402188 </code></pre>
<p>Note that the coefficients and predictions computed here are the same and that the bootstrapped confidence intervals are approximately the same here as in the results from using the raw data.</p>
<p>   </p>
</div>
<div id="comparing-logistic-regressions-between-groups" class="section level2">
<h2>Comparing Logistic Regressions Between Groups</h2>
<p>It may be important to determine if the fit of the logistic regression differs between two groups. For example, one may need to determine if the logistic regression parameters differ significantly between fish captured “pre-2002” and those captured in “2002 and after” (recall that these two “eras” are recorded in <code>era</code> in <code>df</code>).</p>
<p>The model required to answer this type of question is a logistic regression version of the dummy variable regression introduced in Chapter X. Specifically, the right side of the formula in <code>glm</code> is modified to be <code>quantiative*factor</code> where <code>quantiative</code> is the covariate (usually length or age) and <code>factor</code> is the group factor variable that is used to identify the groups being compared. As noted in Chapter X, this formula is actually shorthand for a model with three terms – <code>quantivative</code> and <code>factor</code> main effects and the interaction between the <code>quantitative</code> and <code>factor</code> variables. In this case, the model is fit as shown below.</p>
<pre class="r"><code>&gt; glm3 &lt;- glm(maturity~length*era,data=df,family=binomial)</code></pre>
<p>The significance of terms in a general linear model are computed with a chi-square distribution and summarized in an “Analysis of Deviance Table”, rather than with an F distribution and ANOVA table as with a linear model. Fortunately, the Analysis of Deviance table using Type II tests is also retrieved with <code>Anova()</code> from <code>car</code>.</p>
<pre class="r"><code>&gt; Anova(glm3)</code></pre>
<pre><code>Analysis of Deviance Table (Type II tests)

Response: maturity
           LR Chisq Df Pr(&gt;Chisq)
length       68.599  1    &lt; 2e-16
era           0.005  1    0.94541
length:era    3.100  1    0.07831</code></pre>
<p>As with the ANOVA table in a dummy variable regression, the Analysis of Deviance table should be read from the bottom. In this case, the interaction term is not signficant which suggests that the slopes for the logit-transformed models do not differ between the eras. The <code>era</code> main effect is also not signficant, which suggests that the y-intercepts for the logit-transformed models do not differ between the eras. Thus, there is not signficant differ in the logistic regressions between fish captured in the two eras.</p>
<pre class="r"><code>&gt; ## Set-up colors
&gt; clrs1 &lt;- c(&quot;black&quot;,&quot;red&quot;)
&gt; clrs2 &lt;- col2rgbt(clrs1,1/5)
&gt; ## Get predicted values for each era
&gt; lvls &lt;- levels(df$era)
&gt; lens &lt;- seq(30,70,length.out=99)
&gt; pa02 &lt;- predict(glm3,type=&quot;response&quot;,
                  data.frame(length=lens,era=factor(&quot;2002 and after&quot;,levels=lvls)))
&gt; pp02 &lt;- predict(glm3,type=&quot;response&quot;,
                  data.frame(length=lens,era=factor(&quot;pre-2002&quot;,levels=lvls)))
&gt; ## Make the base plot
&gt; plot((as.numeric(maturity)-1)~length,data=filterD(df,era==lvls[1]),
       pch=19,col=clrs2[1],xlab=&quot;Total Length (cm)&quot;,ylab=&quot;Proportion Mature&quot;)
&gt; points((as.numeric(maturity)-1)~length,data=filterD(df,era==lvls[2]),
       pch=19,col=clrs2[2])
&gt; ## Add the two fitted lines
&gt; lines(pa02~lens,lwd=2,col=clrs1[1])
&gt; lines(pp02~lens,lwd=2,col=clrs1[2])</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-20-1.png" title="" alt="" width="336" /></p>
<p>Figure 4: Fitted logistic regression for proportion of female Yelloweye Rockfish mature by total length separated by the “pre-2002” and “2002 and after” periods.</p>
<hr />
</div>
<div id="reproducibility-information" class="section level2">
<h2>Reproducibility Information</h2>
<ul>
<li><strong>Compiled Date:</strong> Sat Oct 24 2015</li>
<li><strong>Compiled Time:</strong> 7:15:07 PM</li>
<li><strong>R Version:</strong> R version 3.2.2 (2015-08-14)</li>
<li><strong>System:</strong> Windows, i386-w64-mingw32/i386 (32-bit)</li>
<li><strong>Base Packages:</strong> base, datasets, graphics, grDevices, methods, stats, utils</li>
<li><strong>Required Packages:</strong> FSA, magrittr, dplyr, lubridate, car, captioner, knitr and their dependencies (assertthat, DBI, digest, evaluate, formatR, graphics, grDevices, highr, lazyeval, markdown, MASS, memoise, methods, mgcv, nnet, pbkrtest, plotrix, plyr, quantreg, R6, Rcpp, stats, stringr, tools, utils, yaml)</li>
<li><strong>Other Packages:</strong> captioner_2.2.3, car_2.1-0, dplyr_0.4.3, extrafont_0.17, FSA_0.8.3, knitr_1.11, lubridate_1.3.3, magrittr_1.5</li>
<li><strong>Loaded-Only Packages:</strong> assertthat_0.1, DBI_0.3.1, digest_0.6.8, evaluate_0.8, extrafontdb_1.0, formatR_1.2.1, gdata_2.17.0, grid_3.2.2, gtools_3.5.0, highr_0.5.1, htmltools_0.2.6, lattice_0.20-33, lazyeval_0.1.10, lme4_1.1-10, MASS_7.3-44, Matrix_1.2-2, MatrixModels_0.4-1, memoise_0.2.1, mgcv_1.8-7, minqa_1.2.4, nlme_3.1-122, nloptr_1.0.4, nnet_7.3-11, parallel_3.2.2, pbkrtest_0.4-2, plyr_1.8.3, quantreg_5.19, R6_2.1.1, Rcpp_0.12.1, rmarkdown_0.8.1, Rttf2pt1_1.3.3, SparseM_1.7, splines_3.2.2, stringi_0.5-5, stringr_1.0.0, tools_3.2.2, yaml_2.1.13</li>
<li><strong>Links:</strong> <a href="maturity.R">Script</a> / <a href="index.Rmd">RMarkdown</a></li>
</ul>
<hr />
<div class="references">
<h2>References</h2>
<p>Pope, K. L., S. E. Lochmann, and M. K. Young. 2010. Methods for assessing fish populations. Pages 325–351 <em>in</em> W. A. Hubert and M. C. Quist, editors. Inland fisheries management in north americaThird. American Fisheries Society, Bethesda, MD.</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
