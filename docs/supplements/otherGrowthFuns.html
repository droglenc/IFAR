<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Derek H. Ogle">

<title>IFAR - Other Growth Functions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<link href="..//img/IFARCover_small.jpg" rel="icon" type="image/jpeg">
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../helpers/styles.css">
<meta property="og:title" content="IFAR - Other Growth Functions">
<meta property="og:description" content="">
<meta property="og:site-name" content="IFAR">
<meta name="citation_title" content="Other Growth Functions">
<meta name="citation_author" content="Derek H. Ogle">
<meta name="citation_fulltext_html_url" content="https://derekogle.com/IFAR//otherGrowthFuns.html">
<meta name="citation_language" content="en">
<meta name="citation_reference" content="citation_title=Introductory Fisheries Analyses with R;,citation_author=Derek H. Ogle;,citation_publication_date=2016;,citation_cover_date=2016;,citation_year=2016;,citation_fulltext_html_url=http://derekogle.com/IFAR/;">
<meta name="citation_reference" content="citation_title=On the Dynamics of Exploited Fish Populations;,citation_author=R. J. H. Beverton;,citation_author=S. J. Holt;,citation_publication_date=1957;,citation_cover_date=1957;,citation_year=1957;,citation_volume=19;,citation_series_title=Fisheries Investigations (Series 2);">
<meta name="citation_reference" content="citation_title=Standard intercepts for calculating lengths from scale measurements for some centrarchid and percid fishes;,citation_author=K. D. Carlander;,citation_publication_date=1982;,citation_cover_date=1982;,citation_year=1982;,citation_volume=111;,citation_journal_title=Transactions of the American Fisheries Society;">
<meta name="citation_reference" content="citation_title=Minpack.lm: R Interface to the Levenberg-Marquardt Nonlinear Least-Squares Algorithm Found in MINPACK, Plus Support for Bounds;,citation_author=Timur V. Elzhov;,citation_author=Katharine M. Mullen;,citation_author=Andrej-Nikolai Spiess;,citation_author=Ben M. Bolker;,citation_publication_date=2013;,citation_cover_date=2013;,citation_year=2013;,citation_fulltext_html_url=http://CRAN.R-project.org/package=minpack.lm;">
<meta name="citation_reference" content="citation_title=Are growth parameters estimated from tagging and age-length data comparable?;,citation_author=R. I. C. C. Francis;,citation_publication_date=1988;,citation_cover_date=1988;,citation_year=1988;,citation_volume=45;,citation_journal_title=Canadian Journal of Fisheries and Aquatic Sciences;">
<meta name="citation_reference" content="citation_title=Back-calculation of fish length: A critical review;,citation_author=R. I. C. C. Francis;,citation_publication_date=1990;,citation_cover_date=1990;,citation_year=1990;,citation_volume=36;,citation_journal_title=Journal of Fish Biology;">
<meta name="citation_reference" content="citation_title=Growth of the spring salmon;,citation_author=C. McL. Fraser;,citation_publication_date=1916;,citation_cover_date=1916;,citation_year=1916;,citation_volume=1915;,citation_journal_title=Transactions of the Pacific Fisheries Society;">
<meta name="citation_reference" content="citation_title=On the nature of the function expressive of the law of human mortality and on a new mode of determining the value of life contingencies.;,citation_author=B. Gompertz;,citation_publication_date=1825;,citation_cover_date=1825;,citation_year=1825;,citation_volume=115;,citation_journal_title=Philosophical Transactions of the Royal Society of London;">
<meta name="citation_reference" content="citation_title=Dates and times made easy with lubridate;,citation_author=Garrett Grolemund;,citation_author=Hadley Wickham;,citation_publication_date=2011;,citation_cover_date=2011;,citation_year=2011;,citation_fulltext_html_url=http://www.jstatsoft.org/v40/i03/;,citation_issue=3;,citation_volume=40;,citation_journal_title=Journal of Statistical Software;">
<meta name="citation_reference" content="citation_title=nls2: Non-Linear Regression with Brute Force;,citation_author=G. Grothendieck;,citation_publication_date=2013;,citation_cover_date=2013;,citation_year=2013;,citation_fulltext_html_url=http://CRAN.R-project.org/package=nls2;">
<meta name="citation_reference" content="citation_title=On the methods used in the Herring-investigations.;,citation_author=E. Lea;,citation_publication_date=1910;,citation_cover_date=1910;,citation_year=1910;,citation_issue=1;,citation_volume=108;,citation_journal_title=Publ. Circonst. Cons. perm. int. Explor. Mer;">
<meta name="citation_reference" content="citation_title=A review of the methods of age and growth determination in fishes by means of scales.;,citation_author=R. M. Lee;,citation_publication_date=1920;,citation_cover_date=1920;,citation_year=1920;,citation_issue=(2);,citation_volume=4;,citation_journal_title=Fisheries Investigations, London Series 2;">
<meta name="citation_reference" content="citation_title=Analysis and comparison of fish growth from small samples of length-at-age data: Detection of sexual dimorphism in Eurasian Perch as an example;,citation_author=W. M. Mooij;,citation_author=J. M. Van Rooij;,citation_author=S. Wijnhoven;,citation_publication_date=1999;,citation_cover_date=1999;,citation_year=1999;,citation_volume=128;,citation_journal_title=Transactions of the American Fisheries Society;">
<meta name="citation_reference" content="citation_title=Fitting curves to data using nonlinear regression: A practical and nonmathematical review;,citation_abstract=Many types of data are best analyzed by fitting a curve using nonlinear regression, and computer programs that perform these calculations are readily available. Like every scientific technique, however, a nonlinear regression program can produce misleading results when used inappropriately. This article reviews the use of nonlinear regression in a practical and nonmathematical manner to answer the following questions: Why is nonlinear regression superior to linear regression of transformed data? How does nonlinear regression differ from polynomial regression and cubic spline? How do nonlinear regression programs work? What choices must an investigator make before performing nonlinear regression? What do the final results mean? How can two sets of data or two fits to one set of data be compared? What problems can cause the results to be wrong? This review is designed to demystify nonlinear regression so that both its power and its limitations will be appreciated.;,citation_author=H. J. Motulsky;,citation_author=L. A. Ransnas;,citation_publication_date=1987;,citation_cover_date=1987;,citation_year=1987;,citation_fulltext_html_url=http://www.fasebj.org/content/1/5/365.full.pdf+html;,citation_volume=1;,citation_journal_title=The Federation of American Societies for Experimental Biology Journal;">
<meta name="citation_reference" content="citation_title=Nlmrt: Functions for Nonlinear Least Squares Solutions;,citation_author=John C. Nash;,citation_publication_date=2014;,citation_cover_date=2014;,citation_year=2014;,citation_fulltext_html_url=http://CRAN.R-project.org/package=nlmrt;">
<meta name="citation_reference" content="citation_title=Ruffe length-weight relationships with a proposed standard weight equation;,citation_author=D. H. Ogle;,citation_author=I. J. Winfield;,citation_publication_date=2009;,citation_cover_date=2009;,citation_year=2009;,citation_fulltext_html_url=http://www.tandfonline.com/doi/abs/10.1577/M08-176.1#.U6ojzvldV8E;,citation_volume=29;,citation_journal_title=North American Journal of Fisheries Management;">
<meta name="citation_reference" content="citation_title=Methods for Assessing Fish Populations;,citation_author=Kevin L. Pope;,citation_author=Steve E. Lochmann;,citation_author=Michael K. Young;,citation_editor=W. A. Hubert;,citation_editor=M. C. Quist;,citation_publication_date=2010;,citation_cover_date=2010;,citation_year=2010;,citation_inbook_title=Inland Fisheries Management in North America;">
<meta name="citation_reference" content="citation_title=A flexible growth function for empirical use;,citation_author=F. J. Richards;,citation_publication_date=1959;,citation_cover_date=1959;,citation_year=1959;,citation_volume=10;,citation_journal_title=Journal of Experimental Botany;">
<meta name="citation_reference" content="citation_title=Computation and Interpretation of Biological Statistics of Fish Populations;,citation_author=W. E. Ricker;,citation_publication_date=1975;,citation_cover_date=1975;,citation_year=1975;,citation_technical_report_institution=Bulletin of the Fisheries Research Board of Canada;,citation_technical_report_number=Bulletin 191;">
<meta name="citation_reference" content="citation_title=A versatile growth model with statistically stable parameters;,citation_author=J. Schnute;,citation_publication_date=1981;,citation_cover_date=1981;,citation_year=1981;,citation_volume=38;,citation_journal_title=Canadian Journal of Fisheries and Aquatic Sciences;">
<meta name="citation_reference" content="citation_title=A unified approach to the analysis of fish growth, maturity, and survivorship data;,citation_author=J. T. Schnute;,citation_author=L. J. Richards;,citation_publication_date=1990;,citation_cover_date=1990;,citation_year=1990;,citation_volume=47;,citation_journal_title=Canadian Journal of Fisheries and Aquatic Sciences;">
<meta name="citation_reference" content="citation_title=The back-calculation of fish growth from otoliths;,citation_author=L. Vigliola;,citation_author=M. G. Meekan;,citation_editor=B. S. Green;,citation_editor=B. D. Mapstone;,citation_editor=G. Carlos;,citation_editor=G. A. Begg;,citation_publication_date=2009;,citation_cover_date=2009;,citation_year=2009;,citation_inbook_title=Tropical Fish Otoliths: Information for Assessment, Management, and Ecology;,citation_series_title=Reviews: Methods and Technologies in Fish Biology and Fisheries;">
<meta name="citation_reference" content="citation_title=A quantitative theory of organic growth (inquiries on growth laws II);,citation_author=L. Bertalanffy;,citation_publication_date=1938;,citation_cover_date=1938;,citation_year=1938;,citation_volume=10;,citation_journal_title=Human Biology;">
<meta name="citation_reference" content="citation_title=Using hard-part increment data to estimate age and environmental effects;,citation_author=S. Weisberg;,citation_publication_date=1993;,citation_cover_date=1993;,citation_year=1993;,citation_issue=6;,citation_volume=50;,citation_journal_title=Canadian Journal of Fisheries and Aquatic Sciences;">
<meta name="citation_reference" content="citation_title=Interpretation of body-scale regression for computing body length of fish.;,citation_author=R. R. Whitney;,citation_author=K. D. Carlander;,citation_publication_date=1956;,citation_cover_date=1956;,citation_year=1956;,citation_volume=20;,citation_journal_title=Journal of Wildlife Management;">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Introductory Fisheries Analyses with R by Derek H. Ogle</span>
    </a>
  </div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup">Setup</a>
  <ul class="collapse">
  <li><a href="#packages" id="toc-packages" class="nav-link" data-scroll-target="#packages">Packages</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a></li>
  </ul></li>
  <li><a href="#fitting-richards-function" id="toc-fitting-richards-function" class="nav-link" data-scroll-target="#fitting-richards-function">Fitting Richards Function</a></li>
  <li><a href="#comparing-growth-function-fits" id="toc-comparing-growth-function-fits" class="nav-link" data-scroll-target="#comparing-growth-function-fits">Comparing Growth Function Fits</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Other Growth Functions</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Derek H. Ogle </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<p>&nbsp;</p>
<p>Mean length-at-age has been modeled by functions other than the von Bertalanffy Growth Function (VBGF) that was introduced in Chapter 12 of <span class="citation" data-cites="ogleIntroductoryFisheriesAnalyses2016">Ogle (<a href="#ref-ogleIntroductoryFisheriesAnalyses2016" role="doc-biblioref">2016</a>)</span>. Other common functions are the exponential, logistic, and polynomial <span class="citation" data-cites="ricker_computation_1975">(<a href="#ref-ricker_computation_1975" role="doc-biblioref">Ricker 1975</a>)</span>, as well as the specific functions of <span class="citation" data-cites="gompertz_nature_1825">Gompertz (<a href="#ref-gompertz_nature_1825" role="doc-biblioref">1825</a>)</span>, <span class="citation" data-cites="richards_flexible_1959">Richards (<a href="#ref-richards_flexible_1959" role="doc-biblioref">1959</a>)</span>, and <span class="citation" data-cites="schnute_versatile_1981">Schnute (<a href="#ref-schnute_versatile_1981" role="doc-biblioref">1981</a>)</span>. Several of these functions are used in this supplement to demonstrate how to fit growth functions other than the VBGF.</p>
<section id="setup" class="level1 page-columns page-full">
<h1>Setup</h1>
<section id="packages" class="level2">
<h2 class="anchored" data-anchor-id="packages">Packages</h2>
<p>Functions used in this supplement require the following packages.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FSA)      <span class="co"># for vbFuns(), logisticFuns(), GompertzFuns(), RichardsFuns()</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)    <span class="co"># for select(), filter()</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlstools) <span class="co"># for nlsBoot()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Also note that one function from <code>AICcmodavg</code> is used below with <code>::</code> so that the whole package does not have to be loaded.</p>
<div class="cell" data-layout-align="center">

</div>
</section>
<section id="data" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="data">Data</h2>
<div class="page-columns page-full"><p>The male <a href="https://fishr-core-team.github.io/FSAdata/reference/BlackDrum2001.html">Black Drum data</a>.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> used in <span class="citation" data-cites="ogleIntroductoryFisheriesAnalyses2016">Ogle (<a href="#ref-ogleIntroductoryFisheriesAnalyses2016" role="doc-biblioref">2016</a>)</span> are also used in this supplement. As in <span class="citation" data-cites="ogleIntroductoryFisheriesAnalyses2016">Ogle (<a href="#ref-ogleIntroductoryFisheriesAnalyses2016" role="doc-biblioref">2016</a>)</span> a few unneeded variables are removed for simplicity, only males are examined, and a single old fish is removed by including only fish with an otolith age less than 50.</p><div class="no-row-height column-margin column-container"><li id="fn1"><p><sup>1</sup>&nbsp;Download data with CSV link on the linked page.</p></li></div></div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>bdm <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://raw.githubusercontent.com/fishR-Core-Team/FSAdata/main/data-raw/BlackDrum2001.csv"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(spname,day,weight)) <span class="sc">|&gt;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sex<span class="sc">==</span><span class="st">"male"</span>,otoage<span class="sc">&lt;</span><span class="dv">50</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">headtail</span>(bdm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="output"><code>#R|     year agid month     tl  sex otoage
#R|  1  2001    1     4  787.5 male      6
#R|  2  2001    2     5  700.0 male      5
#R|  3  2001    8     5 1140.0 male     23
#R|  72 2001  122     5 1175.0 male     39
#R|  73 2001  125     6  590.0 male      4
#R|  74 2001  127     6  530.0 male      3</code></pre>
</div>
</div>
<p>&nbsp;</p>
</section>
</section>
<section id="fitting-richards-function" class="level1 page-columns page-full">
<h1>Fitting Richards Function</h1>
<p>The “Schnute” model and several parameterizations of the logistic, Gompertz, and Richards models have been coded in convenience functions in <code>FSA</code>. For example, the default parameterizations of the logistic, Gompertz, and Richards models are defined below.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>l1 <span class="ot">&lt;-</span> <span class="fu">logisticFuns</span>()</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">GompertzFuns</span>()</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>r1 <span class="ot">&lt;-</span> <span class="fu">RichardsFuns</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="page-columns page-full"><p>Unfortunately, convenience functions for finding starting values for each of these functions do not exist. Starting values may be obtained by iteratively superimposing a curve of the function at chosen values for the parameters onto a scatterplot of the raw data. This process may take considerable trial-and-error to find parameter values that provide a curve in the “neighborhood” of the data.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> The code below demonstrates this process for the Richards function created above in <code>r1()</code>.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p><div class="no-row-height column-margin column-container"><li id="fn2"><p><sup>2</sup>&nbsp;Starting values likely only need to provide a rough fit to the data, though I had considerable difficulty finding starting values for the Richards function with these data.</p></li><li id="fn3"><p><sup>3</sup>&nbsp;Note that the Richards function has four parameters – <span class="math inline">\(L_{\infty}\)</span>, <span class="math inline">\(k\)</span>, <span class="math inline">\(a\)</span>, and <span class="math inline">\(b\)</span>.</p></li></div></div>
<div class="cell page-columns page-full" data-layout-align="center" data-par1="true">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tl<span class="sc">~</span>otoage,<span class="at">data=</span>bdm,<span class="at">pch=</span><span class="dv">19</span>,<span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>),</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Otolith Age"</span>,<span class="at">ylab=</span><span class="st">"Total Length (mm)"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>svR1 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">Linf=</span><span class="dv">1200</span>,<span class="at">k=</span><span class="fl">0.1</span>,<span class="at">a=</span><span class="fl">1.1</span>,<span class="at">b=</span><span class="fl">0.4</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">r1</span>(x,<span class="fu">unlist</span>(svR1)),<span class="at">from=</span><span class="dv">3</span>,<span class="at">to=</span><span class="dv">42</span>,<span class="at">add=</span><span class="cn">TRUE</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-RichardsStarts" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="otherGrowthFuns_files/figure-html/fig-RichardsStarts-1.png" class="img-fluid figure-img" width="384"></p>
<p></p><figcaption class="figure-caption margin-caption">Figure&nbsp;1: Richards growth function evaluated at potential starting values superimposed on the length-at-age data for male Black Drum.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>These models may be fit and summarized as illustrated in <span class="citation" data-cites="ogleIntroductoryFisheriesAnalyses2016">Ogle (<a href="#ref-ogleIntroductoryFisheriesAnalyses2016" role="doc-biblioref">2016</a>)</span> and demonstrated below for the Richards function.</p>
<div class="cell" data-layout-align="center" data-hash="otherGrowthFuns_cache/html/unnamed-chunk-6_3ad266416a68c17b891b2a47a3b268c1">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>fitR1 <span class="ot">&lt;-</span> <span class="fu">nls</span>(tl<span class="sc">~</span><span class="fu">r1</span>(otoage,Linf,k,a,b),<span class="at">data=</span>bdm,<span class="at">start=</span>svR1)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>bootR1 <span class="ot">&lt;-</span> <span class="fu">nlsBoot</span>(fitR1)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="at">Ests=</span><span class="fu">coef</span>(fitR1),<span class="fu">confint</span>(bootR1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="output"><code>#R|               Ests      95% LCI      95% UCI
#R|  Linf 1.216988e+03 1.190032e+03 1248.8624847
#R|  k    9.419416e-02 6.593375e-02    0.1451012
#R|  a    1.155605e+00 7.244091e-01    1.2161057
#R|  b    3.793336e-01 2.731837e-01    1.1202240</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(bootR1,r1,<span class="at">t=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="output"><code>#R|       t   Median  95% LCI  95% UCI
#R|  [1,] 3 560.8867 523.3757 604.3954</code></pre>
</div>
</div>
<p>&nbsp;</p>
</section>
<section id="comparing-growth-function-fits" class="level1 page-columns page-full">
<h1>Comparing Growth Function Fits</h1>
<div class="page-columns page-full"><p>Information criterion may be used to identify which of these models best fits the male Black Drum data. To demonstrate this, the von Bertalanffy (as fit in <span class="citation" data-cites="ogleIntroductoryFisheriesAnalyses2016">Ogle (<a href="#ref-ogleIntroductoryFisheriesAnalyses2016" role="doc-biblioref">2016</a>)</span>), Gompertz, and logistic functions are fit to the data first.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p><div class="no-row-height column-margin column-container"><li id="fn4"><p><sup>4</sup>&nbsp;Starting values for the VBGF came from <span class="citation" data-cites="ogleIntroductoryFisheriesAnalyses2016">Ogle (<a href="#ref-ogleIntroductoryFisheriesAnalyses2016" role="doc-biblioref">2016</a>)</span>, those for the Gompertz and logistic followed (but is not shown) a process similar to that used for the Richards function.</p></li></div></div>
<div class="cell" data-layout-align="center">

</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Typical VB</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>vbTyp <span class="ot">&lt;-</span> <span class="fu">vbFuns</span>()</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>svTyp <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">Linf=</span><span class="dv">1193</span>,<span class="at">K=</span><span class="fl">0.13</span>,<span class="at">t0=</span><span class="sc">-</span><span class="fl">2.0</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>fitTyp <span class="ot">&lt;-</span> <span class="fu">nls</span>(tl<span class="sc">~</span><span class="fu">vbTyp</span>(otoage,Linf,K,t0),<span class="at">data=</span>bdm,<span class="at">start=</span>svTyp)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Gompertz</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>svG1 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">Linf=</span><span class="dv">1250</span>,<span class="at">gi=</span><span class="fl">0.15</span>,<span class="at">ti=</span><span class="dv">2</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>fitG1 <span class="ot">&lt;-</span> <span class="fu">nls</span>(tl<span class="sc">~</span><span class="fu">g1</span>(otoage,Linf,gi,ti),<span class="at">data=</span>bdm,<span class="at">start=</span>svG1)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Logistic</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>svL1 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">Linf=</span><span class="dv">1250</span>,<span class="at">gninf=</span><span class="fl">0.15</span>,<span class="at">ti=</span><span class="dv">4</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>fitL1 <span class="ot">&lt;-</span> <span class="fu">nls</span>(tl<span class="sc">~</span><span class="fu">l1</span>(otoage,Linf,gninf,ti),<span class="at">data=</span>bdm,<span class="at">start=</span>svL1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>These objects are then submitted to <code>AICctab</code> to provide a summary table. From this, the Richards models is most supported followed by the VBGF. The logistic and Gompertz models had little support, likely because they force an inflection point in the model which is not apparent in these data.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>AICcmodavg<span class="sc">::</span><span class="fu">aictab</span>(<span class="fu">list</span>(fitTyp,fitL1,fitG1,fitR1),</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">c</span>(<span class="st">"VBGF"</span>,<span class="st">"logistic"</span>,<span class="st">"Gompertz"</span>,<span class="st">"Richards"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre class="output"><code>#R|  
#R|  Model selection based on AICc:
#R|  
#R|           K   AICc Delta_AICc AICcWt Cum.Wt      LL
#R|  Richards 5 779.60       0.00   0.63   0.63 -384.36
#R|  VBGF     4 780.85       1.25   0.34   0.96 -386.14
#R|  Gompertz 4 785.34       5.74   0.04   1.00 -388.38
#R|  logistic 4 790.33      10.73   0.00   1.00 -390.88</code></pre>
</div>
</div>
<p>A plot of the best-fit model for each growth function (<a href="#fig-OtherGFCompare">Figure&nbsp;2</a>) shows, however, that there is likely very little difference in predicted values among the four models.</p>
<div class="cell page-columns page-full" data-layout-align="center" data-par1="true">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tl<span class="sc">~</span>otoage,<span class="at">data=</span>bdm,<span class="at">pch=</span><span class="dv">19</span>,<span class="at">col=</span><span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>),</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Otolith Age"</span>,<span class="at">ylab=</span><span class="st">"Total Length (mm)"</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">vbTyp</span>(x,<span class="fu">coef</span>(fitTyp)),<span class="at">from=</span><span class="dv">3</span>,<span class="at">to=</span><span class="dv">42</span>,<span class="at">add=</span><span class="cn">TRUE</span>,<span class="at">lwd=</span><span class="dv">6</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">r1</span>(x,<span class="fu">coef</span>(fitR1)),<span class="at">from=</span><span class="dv">3</span>,<span class="at">to=</span><span class="dv">42</span>,<span class="at">add=</span><span class="cn">TRUE</span>,<span class="at">lwd=</span><span class="dv">4</span>,<span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">g1</span>(x,<span class="fu">coef</span>(fitG1)),<span class="at">from=</span><span class="dv">3</span>,<span class="at">to=</span><span class="dv">42</span>,<span class="at">add=</span><span class="cn">TRUE</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">l1</span>(x,<span class="fu">coef</span>(fitL1)),<span class="at">from=</span><span class="dv">3</span>,<span class="at">to=</span><span class="dv">42</span>,<span class="at">add=</span><span class="cn">TRUE</span>,<span class="at">col=</span><span class="st">"orange"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display page-columns page-full">
<div id="fig-OtherGFCompare" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="otherGrowthFuns_files/figure-html/fig-OtherGFCompare-1.png" class="img-fluid figure-img" width="384"></p>
<p></p><figcaption class="figure-caption margin-caption">Figure&nbsp;2: Fitted models for the von Bertalanffy (black), Richards (blue), Gompertz (red), and logistic (orange) growth functions fit to the male Black Drum data.</figcaption><p></p>
</figure>
</div>
</div>
</div>



</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-gompertz_nature_1825" class="csl-entry" role="doc-biblioentry">
Gompertz, B. 1825. On the nature of the function expressive of the law of human mortality and on a new mode of determining the value of life contingencies. Philosophical Transactions of the Royal Society of London 115:515–585.
</div>
<div id="ref-ogleIntroductoryFisheriesAnalyses2016" class="csl-entry" role="doc-biblioentry">
Ogle, D. H. 2016. <a href="http://derekogle.com/IFAR/">Introductory <span>Fisheries</span> <span>Analyses</span> with <span>R</span></a>. CRC Press, Boca Raton, FL.
</div>
<div id="ref-richards_flexible_1959" class="csl-entry" role="doc-biblioentry">
Richards, F. J. 1959. A flexible growth function for empirical use. Journal of Experimental Botany 10:290–300.
</div>
<div id="ref-ricker_computation_1975" class="csl-entry" role="doc-biblioentry">
Ricker, W. E. 1975. Computation and <span>Interpretation</span> of <span>Biological</span> <span>Statistics</span> of <span>Fish</span> <span>Populations</span>. Bulletin of the Fisheries Research Board of Canada.
</div>
<div id="ref-schnute_versatile_1981" class="csl-entry" role="doc-biblioentry">
Schnute, J. 1981. A versatile growth model with statistically stable parameters. Canadian Journal of Fisheries and Aquatic Sciences 38:1128–1140.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp(/https:\/\/derekogle\.com\/IFAR\//);
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Copyright 2019, Derek H. Ogle</div>   
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/droglenc/IFAR">
      <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/fishR_ogle">
      <i class="bi bi-twitter" role="img" aria-label="Twitter">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>



<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>