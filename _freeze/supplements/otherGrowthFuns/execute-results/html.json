{
  "hash": "a6a6f245d6aab11e4233541a66ceba48",
  "result": {
    "markdown": "---\ntitle: \"Other Growth Functions\"\nauthor: \"Derek H. Ogle\"\noutput: html_document\n---\n\n\n&nbsp;\n\nMean length-at-age has been modeled by functions other than the von Bertalanffy Growth Function (VBGF) that was introduced in Chapter 12 of @ogleIntroductoryFisheriesAnalyses2016. Other common functions are the exponential, logistic, and polynomial [@ricker_computation_1975], as well as the specific functions of @gompertz_nature_1825, @richards_flexible_1959, and @schnute_versatile_1981. Several of these functions are used in this supplement to demonstrate how to fit growth functions other than the VBGF.\n\n# Setup\n## Packages\nFunctions used in this supplement require the following packages.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(FSA)      # for vbFuns(), logisticFuns(), GompertzFuns(), RichardsFuns()\nlibrary(dplyr)    # for select(), filter()\nlibrary(nlstools) # for nlsBoot()\n```\n:::\n\n\nAlso note that one function from `AICcmodavg` is used below with `::` so that the whole package does not have to be loaded.\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n## Data\nThe male [Black Drum data](https://fishr-core-team.github.io/FSAdata/reference/BlackDrum2001.html).^[Download data with CSV link on the linked page.] used in @ogleIntroductoryFisheriesAnalyses2016 are also used in this supplement. As in @ogleIntroductoryFisheriesAnalyses2016 a few unneeded variables are removed for simplicity, only males are examined, and a single old fish is removed by including only fish with an otolith age less than 50.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nbdm <- read.csv(\"https://raw.githubusercontent.com/fishR-Core-Team/FSAdata/main/data-raw/BlackDrum2001.csv\") |>\n  select(-c(spname,day,weight)) |>\n  filter(sex==\"male\",otoage<50)\nheadtail(bdm)\n```\n\n::: {.cell-output .cell-output-stdout}\n```{.output}\n#R|     year agid month     tl  sex otoage\n#R|  1  2001    1     4  787.5 male      6\n#R|  2  2001    2     5  700.0 male      5\n#R|  3  2001    8     5 1140.0 male     23\n#R|  72 2001  122     5 1175.0 male     39\n#R|  73 2001  125     6  590.0 male      4\n#R|  74 2001  127     6  530.0 male      3\n```\n:::\n:::\n\n\n&nbsp;\n\n# Fitting Richards Function\n\nThe \"Schnute\" model and several parameterizations of the logistic, Gompertz, and Richards models have been coded in convenience functions in `FSA`. For example, the default parameterizations of the logistic, Gompertz, and Richards models are defined below.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nl1 <- logisticFuns()\ng1 <- GompertzFuns()\nr1 <- RichardsFuns()\n```\n:::\n\n\nUnfortunately, convenience functions for finding starting values for each of these functions do not exist. Starting values may be obtained by iteratively superimposing a curve of the function at chosen values for the parameters onto a scatterplot of the raw data. This process may take considerable trial-and-error to find parameter values that provide a curve in the \"neighborhood\" of the data.^[Starting values likely only need to provide a rough fit to the data, though I had considerable difficulty finding starting values for the Richards function with these data.] The code below demonstrates this process for the Richards function created above in `r1()`.^[Note that the Richards function has four parameters -- $L_{\\infty}$, $k$, $a$, and $b$.]\n\n\n::: {.cell layout-align=\"center\" par1='true'}\n\n```{.r .cell-code}\nplot(tl~otoage,data=bdm,pch=19,col=rgb(0,0,0,1/4),\n     xlab=\"Otolith Age\",ylab=\"Total Length (mm)\")\nsvR1 <- list(Linf=1200,k=0.1,a=1.1,b=0.4)\ncurve(r1(x,unlist(svR1)),from=3,to=42,add=TRUE,lwd=2)\n```\n\n::: {.cell-output-display}\n![Richards growth function evaluated at potential starting values superimposed on the length-at-age data for male Black Drum.](otherGrowthFuns_files/figure-html/fig-RichardsStarts-1.png){#fig-RichardsStarts fig-align='center' width=384}\n:::\n:::\n\n\nThese models may be fit and summarized as illustrated in @ogleIntroductoryFisheriesAnalyses2016 and demonstrated below for the Richards function.\n\n\n::: {.cell layout-align=\"center\" hash='otherGrowthFuns_cache/html/unnamed-chunk-6_3ad266416a68c17b891b2a47a3b268c1'}\n\n```{.r .cell-code}\nfitR1 <- nls(tl~r1(otoage,Linf,k,a,b),data=bdm,start=svR1)\nbootR1 <- nlsBoot(fitR1)\ncbind(Ests=coef(fitR1),confint(bootR1))\n```\n\n::: {.cell-output .cell-output-stdout}\n```{.output}\n#R|               Ests      95% LCI      95% UCI\n#R|  Linf 1.216988e+03 1.190032e+03 1248.8624847\n#R|  k    9.419416e-02 6.593375e-02    0.1451012\n#R|  a    1.155605e+00 7.244091e-01    1.2161057\n#R|  b    3.793336e-01 2.731837e-01    1.1202240\n```\n:::\n\n```{.r .cell-code}\npredict(bootR1,r1,t=3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```{.output}\n#R|       t   Median  95% LCI  95% UCI\n#R|  [1,] 3 560.8867 523.3757 604.3954\n```\n:::\n:::\n\n\n&nbsp;\n\n# Comparing Growth Function Fits\nInformation criterion may be used to identify which of these models best fits the male Black Drum data. To demonstrate this, the von Bertalanffy (as fit in @ogleIntroductoryFisheriesAnalyses2016), Gompertz, and logistic functions are fit to the data first.^[Starting values for the VBGF came from @ogleIntroductoryFisheriesAnalyses2016, those for the Gompertz and logistic followed (but is not shown) a process similar to that used for the Richards function.]\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Typical VB\nvbTyp <- vbFuns()\nsvTyp <- list(Linf=1193,K=0.13,t0=-2.0)\nfitTyp <- nls(tl~vbTyp(otoage,Linf,K,t0),data=bdm,start=svTyp)\n\n# Gompertz\nsvG1 <- list(Linf=1250,gi=0.15,ti=2)\nfitG1 <- nls(tl~g1(otoage,Linf,gi,ti),data=bdm,start=svG1)\n\n# Logistic\nsvL1 <- list(Linf=1250,gninf=0.15,ti=4)\nfitL1 <- nls(tl~l1(otoage,Linf,gninf,ti),data=bdm,start=svL1)\n```\n:::\n\n\nThese objects are then submitted to `AICctab` to provide a summary table. From this, the Richards models is most supported followed by the VBGF. The logistic and Gompertz models had little support, likely because they force an inflection point in the model which is not apparent in these data.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nAICcmodavg::aictab(list(fitTyp,fitL1,fitG1,fitR1),\n                   c(\"VBGF\",\"logistic\",\"Gompertz\",\"Richards\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```{.output}\n#R|  \n#R|  Model selection based on AICc:\n#R|  \n#R|           K   AICc Delta_AICc AICcWt Cum.Wt      LL\n#R|  Richards 5 779.60       0.00   0.63   0.63 -384.36\n#R|  VBGF     4 780.85       1.25   0.34   0.96 -386.14\n#R|  Gompertz 4 785.34       5.74   0.04   1.00 -388.38\n#R|  logistic 4 790.33      10.73   0.00   1.00 -390.88\n```\n:::\n:::\n\n\nA plot of the best-fit model for each growth function (@fig-OtherGFCompare) shows, however, that there is likely very little difference in predicted values among the four models.\n\n\n::: {.cell layout-align=\"center\" par1='true'}\n\n```{.r .cell-code}\nplot(tl~otoage,data=bdm,pch=19,col=rgb(0,0,0,1/4),\n     xlab=\"Otolith Age\",ylab=\"Total Length (mm)\")\ncurve(vbTyp(x,coef(fitTyp)),from=3,to=42,add=TRUE,lwd=6)\ncurve(r1(x,coef(fitR1)),from=3,to=42,add=TRUE,lwd=4,col=\"blue\")\ncurve(g1(x,coef(fitG1)),from=3,to=42,add=TRUE,lwd=2,col=\"red\")\ncurve(l1(x,coef(fitL1)),from=3,to=42,add=TRUE,col=\"orange\")\n```\n\n::: {.cell-output-display}\n![Fitted models for the von Bertalanffy (black), Richards (blue), Gompertz (red), and logistic (orange) growth functions fit to the male Black Drum data.](otherGrowthFuns_files/figure-html/fig-OtherGFCompare-1.png){#fig-OtherGFCompare fig-align='center' width=384}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}